<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 1600">
  <defs>
    <!-- Gradient definitions -->
    <linearGradient id="gmGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FF6B6B;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#FF8E53;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="bcGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4ECDC4;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#44A08D;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="ocGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667EEA;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#764BA2;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="syncPulse" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#00FF00;stop-opacity:0.8"/>
      <stop offset="50%" style="stop-color:#00FF00;stop-opacity:0.2"/>
      <stop offset="100%" style="stop-color:#00FF00;stop-opacity:0"/>
    </linearGradient>
    
    <!-- Arrow markers -->
    <marker id="syncArrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L9,3 L0,6 z" fill="#4ECDC4"/>
    </marker>
    
    <marker id="ppsArrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L9,3 L0,6 z" fill="#FF6B6B"/>
    </marker>
    
    <!-- Filters -->
    <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
    
    <!-- Patterns -->
    <pattern id="gridPattern" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse">
      <line x1="0" y1="0" x2="0" y2="50" stroke="#E0E0E0" stroke-width="0.5"/>
      <line x1="0" y1="0" x2="50" y2="0" stroke="#E0E0E0" stroke-width="0.5"/>
    </pattern>
    
    <!-- Sync pulse animation -->
    <animate id="pulse1" attributeName="opacity" values="0;1;0" dur="1s" repeatCount="indefinite"/>
    <animate id="pulse2" attributeName="opacity" values="0;1;0" dur="1s" begin="0.25s" repeatCount="indefinite"/>
    <animate id="pulse3" attributeName="opacity" values="0;1;0" dur="1s" begin="0.5s" repeatCount="indefinite"/>
    <animate id="pulse4" attributeName="opacity" values="0;1;0" dur="1s" begin="0.75s" repeatCount="indefinite"/>
  </defs>
  
  <!-- Background -->
  <rect x="0" y="0" width="2000" height="1600" fill="#F8F9FA"/>
  <rect x="0" y="0" width="2000" height="1600" fill="url(#gridPattern)"/>
  
  <!-- Title -->
  <text x="1000" y="40" font-size="32" font-weight="bold" text-anchor="middle" fill="#2C3E50">
    IEEE 802.1AS gPTP Time Synchronization Hierarchy
  </text>
  <text x="1000" y="70" font-size="18" text-anchor="middle" fill="#7F8C8D">
    Precision Time Protocol for A2Z Autonomous Vehicle Network
  </text>
  
  <!-- Grandmaster Clock (GPS/GNSS) -->
  <g transform="translate(900, 120)">
    <rect x="0" y="0" width="200" height="100" rx="10" fill="url(#gmGradient)" filter="url(#shadow)"/>
    <text x="100" y="35" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Grandmaster</text>
    <text x="100" y="55" font-size="14" text-anchor="middle" fill="white">GPS/GNSS</text>
    <text x="100" y="75" font-size="12" text-anchor="middle" fill="white">Stratum 0</text>
    <circle cx="170" cy="30" r="8" fill="#00FF00">
      <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" repeatCount="indefinite"/>
    </circle>
    
    <!-- GPS Satellite Icon -->
    <g transform="translate(75, 85)">
      <circle cx="0" cy="0" r="5" fill="white"/>
      <path d="M-10,-5 L10,-5 M-8,0 L8,0 M-10,5 L10,5" stroke="white" stroke-width="1.5"/>
    </g>
  </g>
  
  <!-- GPS Details Box -->
  <g transform="translate(1150, 120)">
    <rect x="0" y="0" width="250" height="100" rx="5" fill="white" stroke="#E0E0E0" stroke-width="1"/>
    <text x="10" y="25" font-size="14" font-weight="bold" fill="#2C3E50">GPS Time Source</text>
    <text x="10" y="45" font-size="12" fill="#7F8C8D">• Accuracy: ±30ns</text>
    <text x="10" y="60" font-size="12" fill="#7F8C8D">• Update Rate: 1 PPS</text>
    <text x="10" y="75" font-size="12" fill="#7F8C8D">• Protocol: NMEA + PPS</text>
    <text x="10" y="90" font-size="12" fill="#7F8C8D">• Holdover: OCXO 1ppb/day</text>
  </g>
  
  <!-- Boundary Clock Layer (Switches) -->
  <g transform="translate(200, 300)">
    <!-- Switch 1 - LAN9692 -->
    <g transform="translate(0, 0)">
      <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#bcGradient)" filter="url(#shadow)"/>
      <text x="90" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="white">BC Switch 1</text>
      <text x="90" y="50" font-size="12" text-anchor="middle" fill="white">LAN9692</text>
      <text x="90" y="65" font-size="10" text-anchor="middle" fill="white">Stratum 1</text>
      <circle cx="160" cy="20" r="5" fill="#00FF00" opacity="0.8">
        <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" begin="0.1s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- Switch 2 - LAN9668 -->
    <g transform="translate(400, 0)">
      <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#bcGradient)" filter="url(#shadow)"/>
      <text x="90" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="white">BC Switch 2</text>
      <text x="90" y="50" font-size="12" text-anchor="middle" fill="white">LAN9668</text>
      <text x="90" y="65" font-size="10" text-anchor="middle" fill="white">Stratum 1</text>
      <circle cx="160" cy="20" r="5" fill="#00FF00" opacity="0.8">
        <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" begin="0.2s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- Switch 3 - LAN9668 -->
    <g transform="translate(800, 0)">
      <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#bcGradient)" filter="url(#shadow)"/>
      <text x="90" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="white">BC Switch 3</text>
      <text x="90" y="50" font-size="12" text-anchor="middle" fill="white">LAN9668</text>
      <text x="90" y="65" font-size="10" text-anchor="middle" fill="white">Stratum 1</text>
      <circle cx="160" cy="20" r="5" fill="#00FF00" opacity="0.8">
        <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" begin="0.3s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- Switch 4 - LAN9662 -->
    <g transform="translate(1200, 0)">
      <rect x="0" y="0" width="180" height="80" rx="8" fill="url(#bcGradient)" filter="url(#shadow)"/>
      <text x="90" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="white">BC Switch 4</text>
      <text x="90" y="50" font-size="12" text-anchor="middle" fill="white">LAN9662</text>
      <text x="90" y="65" font-size="10" text-anchor="middle" fill="white">Stratum 1</text>
      <circle cx="160" cy="20" r="5" fill="#00FF00" opacity="0.8">
        <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" begin="0.4s" repeatCount="indefinite"/>
      </circle>
    </g>
  </g>
  
  <!-- Ordinary Clock Layer (ECUs) -->
  <!-- Row 1 -->
  <g transform="translate(100, 500)">
    <!-- ACU_NO -->
    <g transform="translate(0, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">ACU_NO</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">Jetson Orin</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="0.5s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- ACU_IT -->
    <g transform="translate(180, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">ACU_IT</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">Tiger Lake</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="0.6s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- VCU -->
    <g transform="translate(360, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">VCU</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">TC397</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="0.7s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- TCU -->
    <g transform="translate(540, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">TCU</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">SA8155</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="0.8s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- EDR -->
    <g transform="translate(720, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">EDR</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">iMX8</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="0.9s" repeatCount="indefinite"/>
      </circle>
    </g>
  </g>
  
  <!-- Row 2 ECUs -->
  <g transform="translate(100, 600)">
    <!-- DSSAD -->
    <g transform="translate(90, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">DSSAD</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">ARM A53</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="1.0s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- CMU -->
    <g transform="translate(270, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">CMU</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">Cortex-M7</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="1.1s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- LiDAR ECU -->
    <g transform="translate(450, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">LiDAR ECU</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">FPGA</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="1.2s" repeatCount="indefinite"/>
      </circle>
    </g>
    
    <!-- Camera ECU -->
    <g transform="translate(630, 0)">
      <rect x="0" y="0" width="140" height="60" rx="6" fill="url(#ocGradient)" filter="url(#shadow)"/>
      <text x="70" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Camera ECU</text>
      <text x="70" y="40" font-size="10" text-anchor="middle" fill="white">ISP</text>
      <text x="70" y="52" font-size="9" text-anchor="middle" fill="white">Stratum 2</text>
      <circle cx="120" cy="15" r="4" fill="#00FF00" opacity="0.6">
        <animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" begin="1.3s" repeatCount="indefinite"/>
      </circle>
    </g>
  </g>
  
  <!-- Connection Lines -->
  <!-- GM to BC -->
  <line x1="1000" y1="220" x2="290" y2="300" stroke="#4ECDC4" stroke-width="2" marker-end="url(#syncArrow)">
    <animate attributeName="stroke-dasharray" values="0,100;100,0" dur="2s" repeatCount="indefinite"/>
  </line>
  <line x1="1000" y1="220" x2="690" y2="300" stroke="#4ECDC4" stroke-width="2" marker-end="url(#syncArrow)">
    <animate attributeName="stroke-dasharray" values="0,100;100,0" dur="2s" repeatCount="indefinite"/>
  </line>
  <line x1="1000" y1="220" x2="1090" y2="300" stroke="#4ECDC4" stroke-width="2" marker-end="url(#syncArrow)">
    <animate attributeName="stroke-dasharray" values="0,100;100,0" dur="2s" repeatCount="indefinite"/>
  </line>
  <line x1="1000" y1="220" x2="1490" y2="300" stroke="#4ECDC4" stroke-width="2" marker-end="url(#syncArrow)">
    <animate attributeName="stroke-dasharray" values="0,100;100,0" dur="2s" repeatCount="indefinite"/>
  </line>
  
  <!-- BC to OC connections (simplified) -->
  <line x1="290" y1="380" x2="170" y2="500" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="290" y1="380" x2="320" y2="500" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="690" y1="380" x2="500" y2="500" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="690" y1="380" x2="680" y2="500" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="1090" y1="380" x2="860" y2="500" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="1090" y1="380" x2="320" y2="600" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="1490" y1="380" x2="500" y2="600" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="1490" y1="380" x2="680" y2="600" stroke="#667EEA" stroke-width="1.5" stroke-dasharray="5,5"/>
  
  <!-- Sync Message Flow Diagram -->
  <g transform="translate(100, 750)">
    <rect x="0" y="0" width="800" height="400" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2"/>
    <text x="400" y="30" font-size="20" font-weight="bold" text-anchor="middle" fill="#2C3E50">gPTP Message Exchange</text>
    
    <!-- Time axis -->
    <line x1="100" y1="70" x2="100" y2="350" stroke="#333" stroke-width="2"/>
    <line x1="700" y1="70" x2="700" y2="350" stroke="#333" stroke-width="2"/>
    <text x="100" y="60" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Master</text>
    <text x="700" y="60" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Slave</text>
    
    <!-- Sync message -->
    <line x1="100" y1="100" x2="700" y2="120" stroke="#4ECDC4" stroke-width="2" marker-end="url(#syncArrow)"/>
    <text x="400" y="105" font-size="12" text-anchor="middle" fill="#4ECDC4">Sync (t1)</text>
    
    <!-- Follow_Up message -->
    <line x1="100" y1="140" x2="700" y2="160" stroke="#4ECDC4" stroke-width="2" marker-end="url(#syncArrow)"/>
    <text x="400" y="145" font-size="12" text-anchor="middle" fill="#4ECDC4">Follow_Up (t1)</text>
    
    <!-- Delay_Req message -->
    <line x1="700" y1="200" x2="100" y2="220" stroke="#667EEA" stroke-width="2" marker-end="url(#syncArrow)"/>
    <text x="400" y="205" font-size="12" text-anchor="middle" fill="#667EEA">Delay_Req (t3)</text>
    
    <!-- Delay_Resp message -->
    <line x1="100" y1="260" x2="700" y2="280" stroke="#667EEA" stroke-width="2" marker-end="url(#syncArrow)"/>
    <text x="400" y="265" font-size="12" text-anchor="middle" fill="#667EEA">Delay_Resp (t4)</text>
    
    <!-- Timestamps -->
    <circle cx="100" cy="100" r="4" fill="#FF6B6B"/>
    <text x="70" y="105" font-size="10" text-anchor="end" fill="#FF6B6B">t1</text>
    
    <circle cx="700" cy="120" r="4" fill="#FF6B6B"/>
    <text x="730" y="125" font-size="10" fill="#FF6B6B">t2</text>
    
    <circle cx="700" cy="200" r="4" fill="#FF6B6B"/>
    <text x="730" y="205" font-size="10" fill="#FF6B6B">t3</text>
    
    <circle cx="100" cy="220" r="4" fill="#FF6B6B"/>
    <text x="70" y="225" font-size="10" text-anchor="end" fill="#FF6B6B">t4</text>
    
    <!-- Calculation -->
    <rect x="150" y="310" width="500" height="30" rx="5" fill="#F0F0F0"/>
    <text x="400" y="330" font-size="12" text-anchor="middle" fill="#333">
      Offset = ((t2-t1) - (t4-t3))/2 | Delay = ((t2-t1) + (t4-t3))/2
    </text>
  </g>
  
  <!-- Synchronization Performance Metrics -->
  <g transform="translate(950, 750)">
    <rect x="0" y="0" width="450" height="400" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2"/>
    <text x="225" y="30" font-size="20" font-weight="bold" text-anchor="middle" fill="#2C3E50">Sync Performance</text>
    
    <!-- Metrics -->
    <g transform="translate(20, 60)">
      <text x="0" y="20" font-size="14" font-weight="bold" fill="#2C3E50">Target Specifications:</text>
      
      <rect x="0" y="30" width="410" height="40" rx="5" fill="#E8F5E9"/>
      <text x="10" y="50" font-size="12" fill="#2E7D32">Master-Slave Accuracy:</text>
      <text x="380" y="50" font-size="12" font-weight="bold" text-anchor="end" fill="#2E7D32">&lt; 100ns</text>
      
      <rect x="0" y="80" width="410" height="40" rx="5" fill="#E3F2FD"/>
      <text x="10" y="100" font-size="12" fill="#1565C0">Network Jitter:</text>
      <text x="380" y="100" font-size="12" font-weight="bold" text-anchor="end" fill="#1565C0">&lt; 50ns</text>
      
      <rect x="0" y="130" width="410" height="40" rx="5" fill="#FFF3E0"/>
      <text x="10" y="150" font-size="12" fill="#E65100">Sync Interval:</text>
      <text x="380" y="150" font-size="12" font-weight="bold" text-anchor="end" fill="#E65100">125ms</text>
      
      <rect x="0" y="180" width="410" height="40" rx="5" fill="#FCE4EC"/>
      <text x="10" y="200" font-size="12" fill="#C2185B">Convergence Time:</text>
      <text x="380" y="200" font-size="12" font-weight="bold" text-anchor="end" fill="#C2185B">&lt; 1s</text>
      
      <rect x="0" y="230" width="410" height="40" rx="5" fill="#F3E5F5"/>
      <text x="10" y="250" font-size="12" fill="#7B1FA2">Holdover Drift:</text>
      <text x="380" y="250" font-size="12" font-weight="bold" text-anchor="end" fill="#7B1FA2">&lt; 1μs/s</text>
      
      <rect x="0" y="280" width="410" height="40" rx="5" fill="#E0F2F1"/>
      <text x="10" y="300" font-size="12" fill="#00695C">BMCA Switch Time:</text>
      <text x="380" y="300" font-size="12" font-weight="bold" text-anchor="end" fill="#00695C">&lt; 3s</text>
    </g>
  </g>
  
  <!-- Clock Domains -->
  <g transform="translate(1450, 450)">
    <rect x="0" y="0" width="500" height="250" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2"/>
    <text x="250" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#2C3E50">Clock Domain Configuration</text>
    
    <g transform="translate(20, 50)">
      <!-- Domain 0 -->
      <rect x="0" y="0" width="220" height="80" rx="5" fill="#FFEBEE"/>
      <text x="110" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#C62828">Domain 0: Primary</text>
      <text x="10" y="40" font-size="11" fill="#333">• GM Priority: 128</text>
      <text x="10" y="55" font-size="11" fill="#333">• Clock Class: 6 (GPS locked)</text>
      <text x="10" y="70" font-size="11" fill="#333">• VLANs: 100, 101</text>
      
      <!-- Domain 1 -->
      <rect x="240" y="0" width="220" height="80" rx="5" fill="#E8EAF6"/>
      <text x="350" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#283593">Domain 1: Backup</text>
      <text x="250" y="40" font-size="11" fill="#333">• GM Priority: 129</text>
      <text x="250" y="55" font-size="11" fill="#333">• Clock Class: 7 (Holdover)</text>
      <text x="250" y="70" font-size="11" fill="#333">• VLANs: 200, 201</text>
    </g>
    
    <!-- PTP Profiles -->
    <g transform="translate(20, 150)">
      <text x="0" y="0" font-size="14" font-weight="bold" fill="#2C3E50">PTP Profiles:</text>
      <rect x="0" y="10" width="460" height="70" rx="5" fill="#F5F5F5"/>
      <text x="10" y="30" font-size="11" fill="#333">• Transport: IEEE 802.3 (Layer 2)</text>
      <text x="10" y="45" font-size="11" fill="#333">• Delay Mechanism: Peer-to-Peer (E2E for backup)</text>
      <text x="10" y="60" font-size="11" fill="#333">• BMCA: Default with automotive extensions</text>
      <text x="10" y="75" font-size="11" fill="#333">• Message Rates: Sync 8/s, Announce 2/s, Delay_Req 32/s</text>
    </g>
  </g>
  
  <!-- Real-time Sync Status -->
  <g transform="translate(1450, 120)">
    <rect x="0" y="0" width="500" height="300" rx="10" fill="#263238" stroke="#37474F" stroke-width="2"/>
    <text x="250" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#00FF00">Real-Time Sync Monitor</text>
    
    <!-- Status indicators -->
    <g transform="translate(20, 50)">
      <circle cx="10" cy="10" r="8" fill="#00FF00">
        <animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite"/>
      </circle>
      <text x="25" y="15" font-size="12" fill="#00FF00">GPS Lock: ACTIVE</text>
      
      <circle cx="250" cy="10" r="8" fill="#00FF00">
        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite"/>
      </circle>
      <text x="265" y="15" font-size="12" fill="#00FF00">PTP Sync: LOCKED</text>
    </g>
    
    <!-- Live metrics -->
    <g transform="translate(20, 90)" font-family="monospace">
      <text x="0" y="0" font-size="11" fill="#76FF03">Current Time: 2024-01-15 14:23:45.123456789</text>
      <text x="0" y="20" font-size="11" fill="#76FF03">GM Offset: +0.000000023 s</text>
      <text x="0" y="40" font-size="11" fill="#76FF03">Path Delay: 0.000000412 s</text>
      <text x="0" y="60" font-size="11" fill="#76FF03">Sync Rate: 8.00 msg/s</text>
      <text x="0" y="80" font-size="11" fill="#76FF03">Active Slaves: 12/12</text>
      <text x="0" y="100" font-size="11" fill="#76FF03">BMCA State: MASTER</text>
      <text x="0" y="120" font-size="11" fill="#76FF03">Clock Drift: +0.002 ppm</text>
      <text x="0" y="140" font-size="11" fill="#76FF03">Temperature: 45.2°C</text>
      <text x="0" y="160" font-size="11" fill="#76FF03">Holdover Time: N/A</text>
      <text x="0" y="180" font-size="11" fill="#76FF03">Last Sync: 0.125s ago</text>
    </g>
  </g>
  
  <!-- Failure Handling -->
  <g transform="translate(100, 1200)">
    <rect x="0" y="0" width="600" height="350" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2"/>
    <text x="300" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#2C3E50">GPS Failure Handling</text>
    
    <!-- State diagram -->
    <g transform="translate(50, 60)">
      <!-- GPS Active -->
      <rect x="0" y="0" width="150" height="60" rx="30" fill="#4CAF50"/>
      <text x="75" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">GPS Locked</text>
      <text x="75" y="45" font-size="11" text-anchor="middle" fill="white">Stratum 0</text>
      
      <!-- Holdover -->
      <rect x="200" y="0" width="150" height="60" rx="30" fill="#FF9800"/>
      <text x="275" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Holdover</text>
      <text x="275" y="45" font-size="11" text-anchor="middle" fill="white">OCXO Backup</text>
      
      <!-- Free Run -->
      <rect x="400" y="0" width="150" height="60" rx="30" fill="#F44336"/>
      <text x="475" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Free Run</text>
      <text x="475" y="45" font-size="11" text-anchor="middle" fill="white">Local Clock</text>
      
      <!-- Transitions -->
      <path d="M150,30 L200,30" stroke="#333" stroke-width="2" marker-end="url(#syncArrow)"/>
      <text x="175" y="20" font-size="10" text-anchor="middle" fill="#333">GPS Loss</text>
      
      <path d="M350,30 L400,30" stroke="#333" stroke-width="2" marker-end="url(#syncArrow)"/>
      <text x="375" y="20" font-size="10" text-anchor="middle" fill="#333">24h timeout</text>
      
      <path d="M275,60 Q275,100 75,60" stroke="#4CAF50" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#syncArrow)"/>
      <text x="175" y="100" font-size="10" text-anchor="middle" fill="#4CAF50">GPS Restore</text>
    </g>
    
    <!-- Holdover performance -->
    <g transform="translate(50, 180)">
      <text x="0" y="0" font-size="14" font-weight="bold" fill="#2C3E50">Holdover Performance:</text>
      <rect x="0" y="10" width="500" height="120" rx="5" fill="#FFF9C4"/>
      <text x="10" y="30" font-size="11" fill="#333">• OCXO Stability: ±1ppb/day</text>
      <text x="10" y="50" font-size="11" fill="#333">• Max Holdover Duration: 24 hours</text>
      <text x="10" y="70" font-size="11" fill="#333">• Accumulated Error @ 1hr: &lt;3.6μs</text>
      <text x="10" y="90" font-size="11" fill="#333">• Accumulated Error @ 24hr: &lt;86.4μs</text>
      <text x="10" y="110" font-size="11" fill="#333">• Auto-switch to backup GM after 1 minute</text>
    </g>
  </g>
  
  <!-- Hardware Timestamping -->
  <g transform="translate(750, 1200)">
    <rect x="0" y="0" width="600" height="350" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2"/>
    <text x="300" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#2C3E50">Hardware Timestamping</text>
    
    <!-- PHY Layer -->
    <g transform="translate(50, 60)">
      <rect x="0" y="0" width="500" height="80" rx="5" fill="#E1F5FE"/>
      <text x="250" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#0277BD">PHY Layer Timestamping</text>
      <text x="10" y="45" font-size="11" fill="#333">• Timestamp Point: Start of Frame Delimiter (SFD)</text>
      <text x="10" y="60" font-size="11" fill="#333">• Resolution: 1ns (1GHz counter)</text>
      <text x="10" y="75" font-size="11" fill="#333">• Hardware: Marvell 88Q2112 / Broadcom BCM89883</text>
    </g>
    
    <!-- MAC Layer -->
    <g transform="translate(50, 160)">
      <rect x="0" y="0" width="500" height="80" rx="5" fill="#F3E5F5"/>
      <text x="250" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#6A1B9A">MAC Layer Support</text>
      <text x="10" y="45" font-size="11" fill="#333">• One-step vs Two-step operation</text>
      <text x="10" y="60" font-size="11" fill="#333">• Ingress/Egress timestamp capture</text>
      <text x="10" y="75" font-size="11" fill="#333">• PTP packet classification and filtering</text>
    </g>
    
    <!-- Software Stack -->
    <g transform="translate(50, 260)">
      <rect x="0" y="0" width="500" height="70" rx="5" fill="#E8F5E9"/>
      <text x="250" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#2E7D32">Software Stack</text>
      <text x="10" y="45" font-size="11" fill="#333">• LinuxPTP (ptp4l) with automotive profile</text>
      <text x="10" y="60" font-size="11" fill="#333">• PHC (PTP Hardware Clock) kernel subsystem</text>
    </g>
  </g>
  
  <!-- BMCA Decision Tree -->
  <g transform="translate(1400, 750)">
    <rect x="0" y="0" width="550" height="400" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2"/>
    <text x="275" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#2C3E50">Best Master Clock Algorithm</text>
    
    <!-- Decision criteria -->
    <g transform="translate(30, 60)">
      <text x="0" y="0" font-size="14" font-weight="bold" fill="#2C3E50">Selection Priority:</text>
      
      <!-- Priority levels -->
      <g transform="translate(0, 20)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#FFCDD2"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#B71C1C">1. Priority1</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">Lower = Better</text>
      </g>
      
      <g transform="translate(0, 60)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#F8BBD0"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#880E4F">2. Clock Class</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">GPS=6, Hold=7, Free=248</text>
      </g>
      
      <g transform="translate(0, 100)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#E1BEE7"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#4A148C">3. Clock Accuracy</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">Lower = Better</text>
      </g>
      
      <g transform="translate(0, 140)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#C5CAE9"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#1A237E">4. Clock Variance</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">Offset Scaled Log Variance</text>
      </g>
      
      <g transform="translate(0, 180)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#B3E5FC"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#01579B">5. Priority2</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">Lower = Better</text>
      </g>
      
      <g transform="translate(0, 220)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#B2DFDB"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#004D40">6. Clock Identity</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">MAC-based UUID</text>
      </g>
      
      <g transform="translate(0, 260)">
        <rect x="0" y="0" width="490" height="35" rx="5" fill="#DCEDC8"/>
        <text x="10" y="22" font-size="12" font-weight="bold" fill="#33691E">7. Port Number</text>
        <text x="450" y="22" font-size="11" text-anchor="end" fill="#333">Lower = Better</text>
      </g>
    </g>
  </g>
</svg>