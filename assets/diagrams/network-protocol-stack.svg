<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2400 1800">
  <defs>
    <!-- Layer gradient definitions -->
    <linearGradient id="appGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8E24AA;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#5E35B1;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="middlewareGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1E88E5;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="transportGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#43A047;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#2E7D32;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="networkGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FB8C00;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#F57C00;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="linkGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E53935;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#C62828;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="physicalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#546E7A;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#37474F;stop-opacity:1"/>
    </linearGradient>
    
    <!-- Arrow markers -->
    <marker id="dataArrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L9,3 L0,6 z" fill="#4CAF50"/>
    </marker>
    
    <!-- Filters -->
    <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-opacity="0.2"/>
    </filter>
    
    <!-- Patterns -->
    <pattern id="gridPattern" x="0" y="0" width="30" height="30" patternUnits="userSpaceOnUse">
      <line x1="0" y1="0" x2="0" y2="30" stroke="#E8E8E8" stroke-width="0.5"/>
      <line x1="0" y1="0" x2="30" y2="0" stroke="#E8E8E8" stroke-width="0.5"/>
    </pattern>
    
    <!-- Data flow animation -->
    <animate id="dataFlow" attributeName="stroke-dashoffset" values="20;0" dur="2s" repeatCount="indefinite"/>
  </defs>
  
  <!-- Background -->
  <rect x="0" y="0" width="2400" height="1800" fill="#FAFAFA"/>
  <rect x="0" y="0" width="2400" height="1800" fill="url(#gridPattern)"/>
  
  <!-- Title -->
  <text x="1200" y="40" font-size="34" font-weight="bold" text-anchor="middle" fill="#2C3E50">
    A2Z Network Protocol Stack Architecture
  </text>
  <text x="1200" y="75" font-size="20" text-anchor="middle" fill="#7F8C8D">
    End-to-End Communication Layers for Autonomous Vehicle Systems
  </text>
  
  <!-- Main Protocol Stack (Left Side) -->
  <g transform="translate(100, 120)">
    <text x="350" y="0" font-size="24" font-weight="bold" text-anchor="middle" fill="#2C3E50">Primary Protocol Stack</text>
    
    <!-- Layer 7: Application -->
    <g transform="translate(0, 50)">
      <rect x="0" y="0" width="700" height="120" rx="10" fill="url(#appGradient)" filter="url(#shadow)"/>
      <text x="20" y="30" font-size="20" font-weight="bold" fill="white">L7: Application Layer</text>
      <text x="20" y="55" font-size="14" fill="white">Vehicle Control Applications & Services</text>
      
      <!-- Application boxes -->
      <g transform="translate(20, 70)">
        <rect x="0" y="0" width="100" height="35" rx="5" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="50" y="22" font-size="11" text-anchor="middle" fill="white">ADAS Control</text>
        
        <rect x="110" y="0" width="100" height="35" rx="5" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="160" y="22" font-size="11" text-anchor="middle" fill="white">Path Planning</text>
        
        <rect x="220" y="0" width="100" height="35" rx="5" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="270" y="22" font-size="11" text-anchor="middle" fill="white">Perception</text>
        
        <rect x="330" y="0" width="100" height="35" rx="5" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="380" y="22" font-size="11" text-anchor="middle" fill="white">Vehicle State</text>
        
        <rect x="440" y="0" width="100" height="35" rx="5" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="490" y="22" font-size="11" text-anchor="middle" fill="white">Diagnostics</text>
        
        <rect x="550" y="0" width="100" height="35" rx="5" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="600" y="22" font-size="11" text-anchor="middle" fill="white">OTA Update</text>
      </g>
    </g>
    
    <!-- Layer 6: Presentation/Middleware -->
    <g transform="translate(0, 180)">
      <rect x="0" y="0" width="700" height="100" rx="10" fill="url(#middlewareGradient)" filter="url(#shadow)"/>
      <text x="20" y="30" font-size="20" font-weight="bold" fill="white">L6: Middleware Layer</text>
      <text x="20" y="55" font-size="14" fill="white">Data Distribution & Service Discovery</text>
      
      <g transform="translate(20, 65)">
        <rect x="0" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="60" y="17" font-size="10" text-anchor="middle" fill="white">DDS (RTPS)</text>
        
        <rect x="130" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="190" y="17" font-size="10" text-anchor="middle" fill="white">ROS2/rclcpp</text>
        
        <rect x="260" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="320" y="17" font-size="10" text-anchor="middle" fill="white">SOME/IP</text>
        
        <rect x="390" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="450" y="17" font-size="10" text-anchor="middle" fill="white">MQTT/CoAP</text>
        
        <rect x="520" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="580" y="17" font-size="10" text-anchor="middle" fill="white">JSON/Protobuf</text>
      </g>
    </g>
    
    <!-- Layer 5: Session (Optional) -->
    <g transform="translate(0, 290)">
      <rect x="0" y="0" width="700" height="60" rx="10" fill="#90A4AE" filter="url(#shadow)"/>
      <text x="20" y="25" font-size="18" font-weight="bold" fill="white">L5: Session Layer</text>
      <text x="20" y="45" font-size="12" fill="white">Connection Management & Authentication (Optional)</text>
    </g>
    
    <!-- Layer 4: Transport -->
    <g transform="translate(0, 360)">
      <rect x="0" y="0" width="700" height="100" rx="10" fill="url(#transportGradient)" filter="url(#shadow)"/>
      <text x="20" y="30" font-size="20" font-weight="bold" fill="white">L4: Transport Layer</text>
      <text x="20" y="55" font-size="14" fill="white">Reliable & Real-time Data Delivery</text>
      
      <g transform="translate(20, 65)">
        <rect x="0" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="50" y="17" font-size="10" text-anchor="middle" fill="white">UDP (Real-time)</text>
        
        <rect x="110" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="160" y="17" font-size="10" text-anchor="middle" fill="white">TCP (Reliable)</text>
        
        <rect x="220" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="270" y="17" font-size="10" text-anchor="middle" fill="white">QUIC/HTTP3</text>
        
        <rect x="330" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="380" y="17" font-size="10" text-anchor="middle" fill="white">SCTP</text>
        
        <rect x="440" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="500" y="17" font-size="10" text-anchor="middle" fill="white">Custom RTOS IPC</text>
      </g>
    </g>
    
    <!-- Layer 3: Network -->
    <g transform="translate(0, 470)">
      <rect x="0" y="0" width="700" height="100" rx="10" fill="url(#networkGradient)" filter="url(#shadow)"/>
      <text x="20" y="30" font-size="20" font-weight="bold" fill="white">L3: Network Layer</text>
      <text x="20" y="55" font-size="14" fill="white">Routing & Address Management</text>
      
      <g transform="translate(20, 65)">
        <rect x="0" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="50" y="17" font-size="10" text-anchor="middle" fill="white">IPv4/IPv6</text>
        
        <rect x="110" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="160" y="17" font-size="10" text-anchor="middle" fill="white">ICMP</text>
        
        <rect x="220" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="270" y="17" font-size="10" text-anchor="middle" fill="white">Multicast</text>
        
        <rect x="330" y="0" width="100" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="380" y="17" font-size="10" text-anchor="middle" fill="white">OSPF/BGP</text>
        
        <rect x="440" y="0" width="120" height="25" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="500" y="17" font-size="10" text-anchor="middle" fill="white">VLAN Routing</text>
      </g>
    </g>
    
    <!-- Layer 2: Data Link -->
    <g transform="translate(0, 580)">
      <rect x="0" y="0" width="700" height="140" rx="10" fill="url(#linkGradient)" filter="url(#shadow)"/>
      <text x="20" y="30" font-size="20" font-weight="bold" fill="white">L2: Data Link Layer</text>
      <text x="20" y="55" font-size="14" fill="white">Frame Management & TSN Features</text>
      
      <!-- TSN Features -->
      <g transform="translate(20, 70)">
        <text x="0" y="10" font-size="12" font-weight="bold" fill="white">TSN Features:</text>
        
        <rect x="0" y="15" width="110" height="45" rx="3" fill="rgba(255,255,255,0.15)" stroke="white" stroke-width="1"/>
        <text x="55" y="30" font-size="9" text-anchor="middle" fill="white">802.1Qbv</text>
        <text x="55" y="42" font-size="8" text-anchor="middle" fill="white">Time Gates</text>
        <text x="55" y="52" font-size="8" text-anchor="middle" fill="white">(TAS)</text>
        
        <rect x="115" y="15" width="110" height="45" rx="3" fill="rgba(255,255,255,0.15)" stroke="white" stroke-width="1"/>
        <text x="170" y="30" font-size="9" text-anchor="middle" fill="white">802.1Qav</text>
        <text x="170" y="42" font-size="8" text-anchor="middle" fill="white">Credit Shaper</text>
        <text x="170" y="52" font-size="8" text-anchor="middle" fill="white">(CBS)</text>
        
        <rect x="230" y="15" width="110" height="45" rx="3" fill="rgba(255,255,255,0.15)" stroke="white" stroke-width="1"/>
        <text x="285" y="30" font-size="9" text-anchor="middle" fill="white">802.1CB</text>
        <text x="285" y="42" font-size="8" text-anchor="middle" fill="white">Redundancy</text>
        <text x="285" y="52" font-size="8" text-anchor="middle" fill="white">(FRER)</text>
        
        <rect x="345" y="15" width="110" height="45" rx="3" fill="rgba(255,255,255,0.15)" stroke="white" stroke-width="1"/>
        <text x="400" y="30" font-size="9" text-anchor="middle" fill="white">802.1AS</text>
        <text x="400" y="42" font-size="8" text-anchor="middle" fill="white">Time Sync</text>
        <text x="400" y="52" font-size="8" text-anchor="middle" fill="white">(gPTP)</text>
        
        <rect x="460" y="15" width="110" height="45" rx="3" fill="rgba(255,255,255,0.15)" stroke="white" stroke-width="1"/>
        <text x="515" y="30" font-size="9" text-anchor="middle" fill="white">802.1Q</text>
        <text x="515" y="42" font-size="8" text-anchor="middle" fill="white">VLAN Tags</text>
        <text x="515" y="52" font-size="8" text-anchor="middle" fill="white">QoS</text>
        
        <rect x="575" y="15" width="110" height="45" rx="3" fill="rgba(255,255,255,0.15)" stroke="white" stroke-width="1"/>
        <text x="630" y="30" font-size="9" text-anchor="middle" fill="white">802.1Qci</text>
        <text x="630" y="42" font-size="8" text-anchor="middle" fill="white">Ingress Filter</text>
        <text x="630" y="52" font-size="8" text-anchor="middle" fill="white">(PSFP)</text>
      </g>
    </g>
    
    <!-- Layer 1: Physical -->
    <g transform="translate(0, 730)">
      <rect x="0" y="0" width="700" height="120" rx="10" fill="url(#physicalGradient)" filter="url(#shadow)"/>
      <text x="20" y="30" font-size="20" font-weight="bold" fill="white">L1: Physical Layer</text>
      <text x="20" y="55" font-size="14" fill="white">Hardware Interface & Signal Transmission</text>
      
      <g transform="translate(20, 70)">
        <rect x="0" y="0" width="110" height="35" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="55" y="15" font-size="10" text-anchor="middle" fill="white">100BASE-T1</text>
        <text x="55" y="27" font-size="8" text-anchor="middle" fill="white">Single Pair</text>
        
        <rect x="115" y="0" width="110" height="35" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="170" y="15" font-size="10" text-anchor="middle" fill="white">1000BASE-T1</text>
        <text x="170" y="27" font-size="8" text-anchor="middle" fill="white">Gigabit</text>
        
        <rect x="230" y="0" width="110" height="35" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="285" y="15" font-size="10" text-anchor="middle" fill="white">2.5GBASE-T1</text>
        <text x="285" y="27" font-size="8" text-anchor="middle" fill="white">Multi-Gig</text>
        
        <rect x="345" y="0" width="110" height="35" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="400" y="15" font-size="10" text-anchor="middle" fill="white">10GBASE-T1</text>
        <text x="400" y="27" font-size="8" text-anchor="middle" fill="white">10G Backbone</text>
        
        <rect x="460" y="0" width="110" height="35" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="515" y="15" font-size="10" text-anchor="middle" fill="white">CAN-FD</text>
        <text x="515" y="27" font-size="8" text-anchor="middle" fill="white">5Mbps</text>
        
        <rect x="575" y="0" width="110" height="35" rx="3" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1"/>
        <text x="630" y="15" font-size="10" text-anchor="middle" fill="white">FlexRay</text>
        <text x="630" y="27" font-size="8" text-anchor="middle" fill="white">10Mbps</text>
      </g>
    </g>
  </g>
  
  <!-- Protocol Mapping (Right Side) -->
  <g transform="translate(900, 120)">
    <text x="350" y="0" font-size="24" font-weight="bold" text-anchor="middle" fill="#2C3E50">Protocol-to-Function Mapping</text>
    
    <!-- Safety-Critical Path -->
    <g transform="translate(0, 50)">
      <rect x="0" y="0" width="700" height="200" rx="10" fill="#FFEBEE" stroke="#F44336" stroke-width="2" filter="url(#shadow)"/>
      <rect x="0" y="0" width="700" height="40" rx="10 10 0 0" fill="#F44336"/>
      <text x="350" y="28" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Safety-Critical Communications</text>
      
      <g transform="translate(20, 60)">
        <text x="0" y="0" font-size="14" font-weight="bold" fill="#C62828">Requirements: E2E Latency &lt; 5ms, 99.999% Reliability</text>
        
        <!-- Safety protocol stack -->
        <g transform="translate(0, 25)">
          <rect x="0" y="0" width="150" height="120" rx="5" fill="white" stroke="#F44336"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#C62828">Steering Control</text>
          <rect x="5" y="20" width="140" height="18" rx="2" fill="#8E24AA"/>
          <text x="75" y="32" font-size="10" text-anchor="middle" fill="white">AUTOSAR AP</text>
          <rect x="5" y="42" width="140" height="18" rx="2" fill="#1E88E5"/>
          <text x="75" y="54" font-size="10" text-anchor="middle" fill="white">DDS (RTPS)</text>
          <rect x="5" y="64" width="140" height="18" rx="2" fill="#43A047"/>
          <text x="75" y="76" font-size="10" text-anchor="middle" fill="white">UDP</text>
          <rect x="5" y="86" width="140" height="18" rx="2" fill="#FB8C00"/>
          <text x="75" y="98" font-size="10" text-anchor="middle" fill="white">IPv4 Multicast</text>
        </g>
        
        <g transform="translate(170, 25)">
          <rect x="0" y="0" width="150" height="120" rx="5" fill="white" stroke="#F44336"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#C62828">Emergency Brake</text>
          <rect x="5" y="20" width="140" height="18" rx="2" fill="#8E24AA"/>
          <text x="75" y="32" font-size="10" text-anchor="middle" fill="white">Custom RT API</text>
          <rect x="5" y="42" width="140" height="18" rx="2" fill="#1E88E5"/>
          <text x="75" y="54" font-size="10" text-anchor="middle" fill="white">Direct IPC</text>
          <rect x="5" y="64" width="140" height="18" rx="2" fill="#43A047"/>
          <text x="75" y="76" font-size="10" text-anchor="middle" fill="white">Raw Socket</text>
          <rect x="5" y="86" width="140" height="18" rx="2" fill="#FB8C00"/>
          <text x="75" y="98" font-size="10" text-anchor="middle" fill="white">Local Loopback</text>
        </g>
        
        <g transform="translate(340, 25)">
          <rect x="0" y="0" width="150" height="120" rx="5" fill="white" stroke="#F44336"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#C62828">Stability Control</text>
          <rect x="5" y="20" width="140" height="18" rx="2" fill="#8E24AA"/>
          <text x="75" y="32" font-size="10" text-anchor="middle" fill="white">Vehicle Dynamics</text>
          <rect x="5" y="42" width="140" height="18" rx="2" fill="#1E88E5"/>
          <text x="75" y="54" font-size="10" text-anchor="middle" fill="white">SOME/IP</text>
          <rect x="5" y="64" width="140" height="18" rx="2" fill="#43A047"/>
          <text x="75" y="76" font-size="10" text-anchor="middle" fill="white">UDP Unicast</text>
          <rect x="5" y="86" width="140" height="18" rx="2" fill="#FB8C00"/>
          <text x="75" y="98" font-size="10" text-anchor="middle" fill="white">IPv4 P2P</text>
        </g>
        
        <g transform="translate(510, 25)">
          <rect x="0" y="0" width="150" height="120" rx="5" fill="white" stroke="#F44336"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#C62828">Watchdog</text>
          <rect x="5" y="20" width="140" height="18" rx="2" fill="#8E24AA"/>
          <text x="75" y="32" font-size="10" text-anchor="middle" fill="white">System Monitor</text>
          <rect x="5" y="42" width="140" height="18" rx="2" fill="#1E88E5"/>
          <text x="75" y="54" font-size="10" text-anchor="middle" fill="white">Custom Protocol</text>
          <rect x="5" y="64" width="140" height="18" rx="2" fill="#43A047"/>
          <text x="75" y="76" font-size="10" text-anchor="middle" fill="white">Kernel Module</text>
          <rect x="5" y="86" width="140" height="18" rx="2" fill="#FB8C00"/>
          <text x="75" y="98" font-size="10" text-anchor="middle" fill="white">Hardware Direct</text>
        </g>
      </g>
    </g>
    
    <!-- Perception & Planning Path -->
    <g transform="translate(0, 270)">
      <rect x="0" y="0" width="700" height="180" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2" filter="url(#shadow)"/>
      <rect x="0" y="0" width="700" height="40" rx="10 10 0 0" fill="#4CAF50"/>
      <text x="350" y="28" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Perception & Planning Communications</text>
      
      <g transform="translate(20, 60)">
        <text x="0" y="0" font-size="14" font-weight="bold" fill="#2E7D32">Requirements: High Bandwidth, &lt; 50ms Latency</text>
        
        <g transform="translate(0, 25)">
          <rect x="0" y="0" width="160" height="100" rx="5" fill="white" stroke="#4CAF50"/>
          <text x="80" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#2E7D32">LiDAR Data</text>
          <rect x="5" y="20" width="150" height="15" rx="2" fill="#8E24AA"/>
          <text x="80" y="30" font-size="9" text-anchor="middle" fill="white">Point Cloud Processing</text>
          <rect x="5" y="38" width="150" height="15" rx="2" fill="#1E88E5"/>
          <text x="80" y="48" font-size="9" text-anchor="middle" fill="white">ROS2/DDS</text>
          <rect x="5" y="56" width="150" height="15" rx="2" fill="#43A047"/>
          <text x="80" y="66" font-size="9" text-anchor="middle" fill="white">UDP Multicast</text>
          <rect x="5" y="74" width="150" height="15" rx="2" fill="#FB8C00"/>
          <text x="80" y="84" font-size="9" text-anchor="middle" fill="white">IPv6 + QoS</text>
        </g>
        
        <g transform="translate(180, 25)">
          <rect x="0" y="0" width="160" height="100" rx="5" fill="white" stroke="#4CAF50"/>
          <text x="80" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#2E7D32">Camera Streams</text>
          <rect x="5" y="20" width="150" height="15" rx="2" fill="#8E24AA"/>
          <text x="80" y="30" font-size="9" text-anchor="middle" fill="white">Vision Pipeline</text>
          <rect x="5" y="38" width="150" height="15" rx="2" fill="#1E88E5"/>
          <text x="80" y="48" font-size="9" text-anchor="middle" fill="white">GStreamer/RTSP</text>
          <rect x="5" y="56" width="150" height="15" rx="2" fill="#43A047"/>
          <text x="80" y="66" font-size="9" text-anchor="middle" fill="white">TCP/RTP</text>
          <rect x="5" y="74" width="150" height="15" rx="2" fill="#FB8C00"/>
          <text x="80" y="84" font-size="9" text-anchor="middle" fill="white">IPv4 Unicast</text>
        </g>
        
        <g transform="translate(360, 25)">
          <rect x="0" y="0" width="160" height="100" rx="5" fill="white" stroke="#4CAF50"/>
          <text x="80" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#2E7D32">Path Planning</text>
          <rect x="5" y="20" width="150" height="15" rx="2" fill="#8E24AA"/>
          <text x="80" y="30" font-size="9" text-anchor="middle" fill="white">Trajectory Compute</text>
          <rect x="5" y="38" width="150" height="15" rx="2" fill="#1E88E5"/>
          <text x="80" y="48" font-size="9" text-anchor="middle" fill="white">Custom API</text>
          <rect x="5" y="56" width="150" height="15" rx="2" fill="#43A047"/>
          <text x="80" y="66" font-size="9" text-anchor="middle" fill="white">gRPC/HTTP2</text>
          <rect x="5" y="74" width="150" height="15" rx="2" fill="#FB8C00"/>
          <text x="80" y="84" font-size="9" text-anchor="middle" fill="white">IPv4 + TLS</text>
        </g>
      </g>
    </g>
    
    <!-- Telemetry & Diagnostics Path -->
    <g transform="translate(0, 470)">
      <rect x="0" y="0" width="700" height="160" rx="10" fill="#FFF3E0" stroke="#FF9800" stroke-width="2" filter="url(#shadow)"/>
      <rect x="0" y="0" width="700" height="40" rx="10 10 0 0" fill="#FF9800"/>
      <text x="350" y="28" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Telemetry & Diagnostics</text>
      
      <g transform="translate(20, 60)">
        <text x="0" y="0" font-size="14" font-weight="bold" fill="#E65100">Requirements: Reliable Delivery, Store & Forward</text>
        
        <g transform="translate(0, 25)">
          <rect x="0" y="0" width="150" height="80" rx="5" fill="white" stroke="#FF9800"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#E65100">System Health</text>
          <rect x="5" y="20" width="140" height="12" rx="2" fill="#8E24AA"/>
          <text x="75" y="28" font-size="8" text-anchor="middle" fill="white">Metrics Collection</text>
          <rect x="5" y="35" width="140" height="12" rx="2" fill="#1E88E5"/>
          <text x="75" y="43" font-size="8" text-anchor="middle" fill="white">MQTT</text>
          <rect x="5" y="50" width="140" height="12" rx="2" fill="#43A047"/>
          <text x="75" y="58" font-size="8" text-anchor="middle" fill="white">TCP Reliable</text>
          <rect x="5" y="65" width="140" height="12" rx="2" fill="#FB8C00"/>
          <text x="75" y="73" font-size="8" text-anchor="middle" fill="white">IPv4/IPv6</text>
        </g>
        
        <g transform="translate(170, 25)">
          <rect x="0" y="0" width="150" height="80" rx="5" fill="white" stroke="#FF9800"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#E65100">Event Logging</text>
          <rect x="5" y="20" width="140" height="12" rx="2" fill="#8E24AA"/>
          <text x="75" y="28" font-size="8" text-anchor="middle" fill="white">Structured Logs</text>
          <rect x="5" y="35" width="140" height="12" rx="2" fill="#1E88E5"/>
          <text x="75" y="43" font-size="8" text-anchor="middle" fill="white">syslog/journald</text>
          <rect x="5" y="50" width="140" height="12" rx="2" fill="#43A047"/>
          <text x="75" y="58" font-size="8" text-anchor="middle" fill="white">UDP/TCP</text>
          <rect x="5" y="65" width="140" height="12" rx="2" fill="#FB8C00"/>
          <text x="75" y="73" font-size="8" text-anchor="middle" fill="white">Local/Remote</text>
        </g>
        
        <g transform="translate(340, 25)">
          <rect x="0" y="0" width="150" height="80" rx="5" fill="white" stroke="#FF9800"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#E65100">OTA Updates</text>
          <rect x="5" y="20" width="140" height="12" rx="2" fill="#8E24AA"/>
          <text x="75" y="28" font-size="8" text-anchor="middle" fill="white">Package Manager</text>
          <rect x="5" y="35" width="140" height="12" rx="2" fill="#1E88E5"/>
          <text x="75" y="43" font-size="8" text-anchor="middle" fill="white">HTTPS/CoAP</text>
          <rect x="5" y="50" width="140" height="12" rx="2" fill="#43A047"/>
          <text x="75" y="58" font-size="8" text-anchor="middle" fill="white">TCP + TLS</text>
          <rect x="5" y="65" width="140" height="12" rx="2" fill="#FB8C00"/>
          <text x="75" y="73" font-size="8" text-anchor="middle" fill="white">IPv4 + DNS</text>
        </g>
        
        <g transform="translate(510, 25)">
          <rect x="0" y="0" width="150" height="80" rx="5" fill="white" stroke="#FF9800"/>
          <text x="75" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#E65100">Fleet Management</text>
          <rect x="5" y="20" width="140" height="12" rx="2" fill="#8E24AA"/>
          <text x="75" y="28" font-size="8" text-anchor="middle" fill="white">Cloud Gateway</text>
          <rect x="5" y="35" width="140" height="12" rx="2" fill="#1E88E5"/>
          <text x="75" y="43" font-size="8" text-anchor="middle" fill="white">REST/GraphQL</text>
          <rect x="5" y="50" width="140" height="12" rx="2" fill="#43A047"/>
          <text x="75" y="58" font-size="8" text-anchor="middle" fill="white">HTTPS</text>
          <rect x="5" y="65" width="140" height="12" rx="2" fill="#FB8C00"/>
          <text x="75" y="73" font-size="8" text-anchor="middle" fill="white">IPv4 + Cellular</text>
        </g>
      </g>
    </g>
    
    <!-- Legacy Vehicle Bus Integration -->
    <g transform="translate(0, 650)">
      <rect x="0" y="0" width="700" height="140" rx="10" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2" filter="url(#shadow)"/>
      <rect x="0" y="0" width="700" height="40" rx="10 10 0 0" fill="#9C27B0"/>
      <text x="350" y="28" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Legacy Vehicle Bus Integration</text>
      
      <g transform="translate(20, 60)">
        <text x="0" y="0" font-size="14" font-weight="bold" fill="#6A1B9A">Gateway Functions: Protocol Translation & Bridging</text>
        
        <g transform="translate(0, 25)">
          <rect x="0" y="0" width="160" height="70" rx="5" fill="white" stroke="#9C27B0"/>
          <text x="80" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#6A1B9A">CAN-FD Gateway</text>
          <rect x="5" y="20" width="150" height="10" rx="1" fill="#8E24AA"/>
          <text x="80" y="27" font-size="7" text-anchor="middle" fill="white">Powertrain/Chassis ECUs</text>
          <rect x="5" y="33" width="150" height="10" rx="1" fill="#1E88E5"/>
          <text x="80" y="40" font-size="7" text-anchor="middle" fill="white">CAN → ETH Bridge</text>
          <rect x="5" y="46" width="150" height="10" rx="1" fill="#43A047"/>
          <text x="80" y="53" font-size="7" text-anchor="middle" fill="white">Message Filtering</text>
          <rect x="5" y="59" width="150" height="10" rx="1" fill="#FB8C00"/>
          <text x="80" y="66" font-size="7" text-anchor="middle" fill="white">500kbps → 1Gbps</text>
        </g>
        
        <g transform="translate(180, 25)">
          <rect x="0" y="0" width="160" height="70" rx="5" fill="white" stroke="#9C27B0"/>
          <text x="80" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#6A1B9A">FlexRay Bridge</text>
          <rect x="5" y="20" width="150" height="10" rx="1" fill="#8E24AA"/>
          <text x="80" y="27" font-size="7" text-anchor="middle" fill="white">Safety Critical Systems</text>
          <rect x="5" y="33" width="150" height="10" rx="1" fill="#1E88E5"/>
          <text x="80" y="40" font-size="7" text-anchor="middle" fill="white">FlexRay → ETH</text>
          <rect x="5" y="46" width="150" height="10" rx="1" fill="#43A047"/>
          <text x="80" y="53" font-size="7" text-anchor="middle" fill="white">Schedule Mapping</text>
          <rect x="5" y="59" width="150" height="10" rx="1" fill="#FB8C00"/>
          <text x="80" y="66" font-size="7" text-anchor="middle" fill="white">10Mbps → 100Mbps</text>
        </g>
        
        <g transform="translate(360, 25)">
          <rect x="0" y="0" width="160" height="70" rx="5" fill="white" stroke="#9C27B0"/>
          <text x="80" y="15" font-size="12" font-weight="bold" text-anchor="middle" fill="#6A1B9A">LIN Gateway</text>
          <rect x="5" y="20" width="150" height="10" rx="1" fill="#8E24AA"/>
          <text x="80" y="27" font-size="7" text-anchor="middle" fill="white">Body/Comfort Systems</text>
          <rect x="5" y="33" width="150" height="10" rx="1" fill="#1E88E5"/>
          <text x="80" y="40" font-size="7" text-anchor="middle" fill="white">LIN → CAN → ETH</text>
          <rect x="5" y="46" width="150" height="10" rx="1" fill="#43A047"/>
          <text x="80" y="53" font-size="7" text-anchor="middle" fill="white">Data Aggregation</text>
          <rect x="5" y="59" width="150" height="10" rx="1" fill="#FB8C00"/>
          <text x="80" y="66" font-size="7" text-anchor="middle" fill="white">19.2kbps → 1Mbps</text>
        </g>
      </g>
    </g>
  </g>
  
  <!-- Performance Metrics Dashboard -->
  <g transform="translate(100, 1150)">
    <rect x="0" y="0" width="800" height="300" rx="10" fill="#263238" stroke="#37474F" stroke-width="2" filter="url(#shadow)"/>
    <text x="400" y="35" font-size="20" font-weight="bold" text-anchor="middle" fill="#00FF00">
      Real-Time Network Performance Metrics
    </text>
    
    <g transform="translate(40, 60)" font-family="monospace">
      <text x="0" y="0" font-size="13" font-weight="bold" fill="#00FF00">Protocol Performance:</text>
      
      <!-- Left column -->
      <text x="0" y="25" font-size="11" fill="#76FF03">DDS/RTPS (Safety):</text>
      <text x="200" y="25" font-size="11" fill="#FFEB3B">Latency: 2.1ms | Jitter: ±0.3ms</text>
      
      <text x="0" y="45" font-size="11" fill="#76FF03">UDP Multicast (Perception):</text>
      <text x="200" y="45" font-size="11" fill="#FFEB3B">Throughput: 2.4Gbps | Loss: 0.001%</text>
      
      <text x="0" y="65" font-size="11" fill="#76FF03">TCP Reliable (Telemetry):</text>
      <text x="200" y="65" font-size="11" fill="#FFEB3B">Queue Depth: 142 msgs | RTT: 15ms</text>
      
      <text x="0" y="85" font-size="11" fill="#76FF03">CAN-FD Gateway:</text>
      <text x="200" y="85" font-size="11" fill="#FFEB3B">Msg Rate: 2.4k/s | Buffer: 85%</text>
      
      <text x="0" y="105" font-size="11" fill="#76FF03">TSN Scheduler:</text>
      <text x="200" y="105" font-size="11" fill="#FFEB3B">TAS Gates: 8/8 | CBS Rate: 95%</text>
      
      <!-- Right column -->
      <text x="400" y="25" font-size="11" fill="#76FF03">FRER Redundancy:</text>
      <text x="580" y="25" font-size="11" fill="#FFEB3B">Duplicate Rate: 0.1% | Recovery: 99.9%</text>
      
      <text x="400" y="45" font-size="11" fill="#76FF03">PTP Sync:</text>
      <text x="580" y="45" font-size="11" fill="#FFEB3B">Offset: +23ns | Drift: -0.02ppm</text>
      
      <text x="400" y="65" font-size="11" fill="#76FF03">QoS Classes Active:</text>
      <text x="580" y="65" font-size="11" fill="#FFEB3B">P7:15% P6:25% P5:35% P0:25%</text>
      
      <text x="400" y="85" font-size="11" fill="#76FF03">Total Bandwidth:</text>
      <text x="580" y="85" font-size="11" fill="#FFEB3B">Used: 6.8/10 Gbps (68%)</text>
      
      <text x="400" y="105" font-size="11" fill="#76FF03">Error Rate:</text>
      <text x="580" y="105" font-size="11" fill="#FFEB3B">CRC: 0 | Timeout: 2 | Overrun: 0</text>
      
      <!-- Status indicators -->
      <g transform="translate(0, 130)">
        <text x="0" y="0" font-size="13" font-weight="bold" fill="#00FF00">System Status:</text>
        
        <circle cx="20" cy="25" r="8" fill="#00FF00">
          <animate attributeName="opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite"/>
        </circle>
        <text x="35" y="30" font-size="11" fill="#00FF00">Network Health: OPTIMAL</text>
        
        <circle cx="250" cy="25" r="8" fill="#00FF00">
          <animate attributeName="opacity" values="0.5;1;0.5" dur="2.5s" repeatCount="indefinite"/>
        </circle>
        <text x="265" y="30" font-size="11" fill="#00FF00">Protocol Stack: ACTIVE</text>
        
        <circle cx="480" cy="25" r="8" fill="#FFEB3B">
          <animate attributeName="opacity" values="0.3;1;0.3" dur="1.5s" repeatCount="indefinite"/>
        </circle>
        <text x="495" y="30" font-size="11" fill="#FFEB3B">TSN Features: ENABLED</text>
        
        <circle cx="20" cy="55" r="8" fill="#00FF00">
          <animate attributeName="opacity" values="0.5;1;0.5" dur="3s" repeatCount="indefinite"/>
        </circle>
        <text x="35" y="60" font-size="11" fill="#00FF00">Redundancy: STANDBY READY</text>
        
        <circle cx="280" cy="55" r="8" fill="#FFEB3B">
          <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite"/>
        </circle>
        <text x="295" y="60" font-size="11" fill="#FFEB3B">Gateway Load: MODERATE</text>
        
        <circle cx="520" cy="55" r="8" fill="#00FF00">
          <animate attributeName="opacity" values="0.5;1;0.5" dur="2.2s" repeatCount="indefinite"/>
        </circle>
        <text x="535" y="60" font-size="11" fill="#00FF00">Security: PROTECTED</text>
      </g>
    </g>
  </g>
  
  <!-- Quality of Service Configuration -->
  <g transform="translate(950, 1150)">
    <rect x="0" y="0" width="800" height="300" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
    <text x="400" y="35" font-size="20" font-weight="bold" text-anchor="middle" fill="#2C3E50">
      QoS Traffic Classification & Scheduling
    </text>
    
    <!-- Traffic classes -->
    <g transform="translate(40, 60)">
      <text x="0" y="0" font-size="14" font-weight="bold" fill="#333">IEEE 802.1Q Priority Mapping:</text>
      
      <!-- Priority 7 -->
      <rect x="0" y="20" width="720" height="30" rx="3" fill="#B71C1C"/>
      <text x="10" y="37" font-size="12" font-weight="bold" fill="white">P7 - Network Control</text>
      <text x="200" y="37" font-size="11" fill="white">Emergency Brake, Steering Commands</text>
      <text x="500" y="37" font-size="11" fill="white">Bandwidth: 10% | Latency: &lt; 1ms</text>
      <text x="680" y="37" font-size="10" fill="white">WRR: 40%</text>
      
      <!-- Priority 6 -->
      <rect x="0" y="55" width="720" height="30" rx="3" fill="#D32F2F"/>
      <text x="10" y="72" font-size="12" font-weight="bold" fill="white">P6 - Internetwork Control</text>
      <text x="200" y="72" font-size="11" fill="white">Vehicle Dynamics, Stability</text>
      <text x="500" y="72" font-size="11" fill="white">Bandwidth: 15% | Latency: &lt; 5ms</text>
      <text x="680" y="72" font-size="10" fill="white">WRR: 30%</text>
      
      <!-- Priority 5 -->
      <rect x="0" y="90" width="720" height="30" rx="3" fill="#F57C00"/>
      <text x="10" y="107" font-size="12" font-weight="bold" fill="white">P5 - Voice (Critical Data)</text>
      <text x="200" y="107" font-size="11" fill="white">Sensor Fusion, Perception</text>
      <text x="500" y="107" font-size="11" fill="white">Bandwidth: 30% | Latency: &lt; 20ms</text>
      <text x="680" y="107" font-size="10" fill="white">WRR: 20%</text>
      
      <!-- Priority 4 -->
      <rect x="0" y="125" width="720" height="30" rx="3" fill="#FBC02D"/>
      <text x="10" y="142" font-size="12" font-weight="bold" fill="white">P4 - Video (High Data)</text>
      <text x="200" y="142" font-size="11" fill="white">Camera Streams, LiDAR</text>
      <text x="500" y="142" font-size="11" fill="white">Bandwidth: 25% | Latency: &lt; 100ms</text>
      <text x="680" y="142" font-size="10" fill="white">WRR: 6%</text>
      
      <!-- Priority 3 -->
      <rect x="0" y="160" width="720" height="25" rx="3" fill="#689F38"/>
      <text x="10" y="175" font-size="11" font-weight="bold" fill="white">P3 - Excellent Effort</text>
      <text x="200" y="175" font-size="10" fill="white">Localization, Mapping</text>
      <text x="500" y="175" font-size="10" fill="white">Bandwidth: 10% | BE+</text>
      <text x="680" y="175" font-size="9" fill="white">WRR: 3%</text>
      
      <!-- Priority 0-2 -->
      <rect x="0" y="190" width="720" height="40" rx="3" fill="#9E9E9E"/>
      <text x="10" y="205" font-size="11" font-weight="bold" fill="white">P0-P2 - Best Effort</text>
      <text x="200" y="205" font-size="10" fill="white">Diagnostics, Logging, Updates, Background</text>
      <text x="500" y="205" font-size="10" fill="white">Bandwidth: Remaining | No guarantee</text>
      <text x="10" y="222" font-size="10" fill="white">P2: Standard | P1: Background | P0: Spare</text>
      <text x="680" y="210" font-size="9" fill="white">WRR: 1%</text>
    </g>
  </g>
  
  <!-- Data Flow Visualization -->
  <g transform="translate(100, 1480)">
    <rect x="0" y="0" width="2100" height="250" rx="10" fill="#F5F5F5" stroke="#BDBDBD" stroke-width="1"/>
    <text x="1050" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">
      End-to-End Data Flow Example: Emergency Braking Scenario
    </text>
    
    <!-- Flow diagram -->
    <g transform="translate(50, 50)">
      <!-- Sensor -->
      <rect x="0" y="50" width="120" height="60" rx="5" fill="#4CAF50"/>
      <text x="60" y="75" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Radar Sensor</text>
      <text x="60" y="92" font-size="10" text-anchor="middle" fill="white">Object Detect</text>
      
      <!-- Protocol stack boxes -->
      <rect x="0" y="120" width="120" height="80" rx="3" fill="white" stroke="#4CAF50"/>
      <rect x="5" y="125" width="110" height="12" rx="2" fill="#8E24AA"/>
      <text x="60" y="133" font-size="8" text-anchor="middle" fill="white">Raw Data</text>
      <rect x="5" y="140" width="110" height="12" rx="2" fill="#1E88E5"/>
      <text x="60" y="148" font-size="8" text-anchor="middle" fill="white">CAN-FD</text>
      <rect x="5" y="155" width="110" height="12" rx="2" fill="#43A047"/>
      <text x="60" y="163" font-size="8" text-anchor="middle" fill="white">Socket CAN</text>
      <rect x="5" y="170" width="110" height="12" rx="2" fill="#FB8C00"/>
      <text x="60" y="178" font-size="8" text-anchor="middle" fill="white">1Mbps CAN</text>
      <rect x="5" y="185" width="110" height="12" rx="2" fill="#546E7A"/>
      <text x="60" y="193" font-size="8" text-anchor="middle" fill="white">Twisted Pair</text>
      
      <!-- Gateway -->
      <rect x="180" y="50" width="120" height="60" rx="5" fill="#FF9800"/>
      <text x="240" y="75" font-size="12" font-weight="bold" text-anchor="middle" fill="white">CAN Gateway</text>
      <text x="240" y="92" font-size="10" text-anchor="middle" fill="white">Protocol Bridge</text>
      
      <rect x="180" y="120" width="120" height="80" rx="3" fill="white" stroke="#FF9800"/>
      <rect x="185" y="125" width="110" height="12" rx="2" fill="#8E24AA"/>
      <text x="240" y="133" font-size="8" text-anchor="middle" fill="white">Message Filter</text>
      <rect x="185" y="140" width="110" height="12" rx="2" fill="#1E88E5"/>
      <text x="240" y="148" font-size="8" text-anchor="middle" fill="white">CAN→ETH</text>
      <rect x="185" y="155" width="110" height="12" rx="2" fill="#43A047"/>
      <text x="240" y="163" font-size="8" text-anchor="middle" fill="white">UDP</text>
      <rect x="185" y="170" width="110" height="12" rx="2" fill="#FB8C00"/>
      <text x="240" y="178" font-size="8" text-anchor="middle" fill="white">IPv4+VLAN</text>
      <rect x="185" y="185" width="110" height="12" rx="2" fill="#546E7A"/>
      <text x="240" y="193" font-size="8" text-anchor="middle" fill="white">100BASE-T1</text>
      
      <!-- TSN Switch -->
      <rect x="360" y="50" width="120" height="60" rx="5" fill="#E53935"/>
      <text x="420" y="75" font-size="12" font-weight="bold" text-anchor="middle" fill="white">TSN Switch</text>
      <text x="420" y="92" font-size="10" text-anchor="middle" fill="white">Traffic Shaper</text>
      
      <rect x="360" y="120" width="120" height="80" rx="3" fill="white" stroke="#E53935"/>
      <rect x="365" y="125" width="110" height="12" rx="2" fill="#8E24AA"/>
      <text x="420" y="133" font-size="8" text-anchor="middle" fill="white">QoS P7</text>
      <rect x="365" y="140" width="110" height="12" rx="2" fill="#1E88E5"/>
      <text x="420" y="148" font-size="8" text-anchor="middle" fill="white">TAS Gate</text>
      <rect x="365" y="155" width="110" height="12" rx="2" fill="#43A047"/>
      <text x="420" y="163" font-size="8" text-anchor="middle" fill="white">Frame Forward</text>
      <rect x="365" y="170" width="110" height="12" rx="2" fill="#FB8C00"/>
      <text x="420" y="178" font-size="8" text-anchor="middle" fill="white">VLAN 100</text>
      <rect x="365" y="185" width="110" height="12" rx="2" fill="#546E7A"/>
      <text x="420" y="193" font-size="8" text-anchor="middle" fill="white">1000BASE-T1</text>
      
      <!-- Processing ECU -->
      <rect x="540" y="50" width="120" height="60" rx="5" fill="#1E88E5"/>
      <text x="600" y="75" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ACU_NO</text>
      <text x="600" y="92" font-size="10" text-anchor="middle" fill="white">Decision Logic</text>
      
      <rect x="540" y="120" width="120" height="80" rx="3" fill="white" stroke="#1E88E5"/>
      <rect x="545" y="125" width="110" height="12" rx="2" fill="#8E24AA"/>
      <text x="600" y="133" font-size="8" text-anchor="middle" fill="white">Emergency Detect</text>
      <rect x="545" y="140" width="110" height="12" rx="2" fill="#1E88E5"/>
      <text x="600" y="148" font-size="8" text-anchor="middle" fill="white">DDS/RTPS</text>
      <rect x="545" y="155" width="110" height="12" rx="2" fill="#43A047"/>
      <text x="600" y="163" font-size="8" text-anchor="middle" fill="white">UDP Multicast</text>
      <rect x="545" y="170" width="110" height="12" rx="2" fill="#FB8C00"/>
      <text x="600" y="178" font-size="8" text-anchor="middle" fill="white">IPv4+DSCP</text>
      <rect x="545" y="185" width="110" height="12" rx="2" fill="#546E7A"/>
      <text x="600" y="193" font-size="8" text-anchor="middle" fill="white">1000BASE-T1</text>
      
      <!-- Control ECU -->
      <rect x="720" y="50" width="120" height="60" rx="5" fill="#8E24AA"/>
      <text x="780" y="75" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Brake ECU</text>
      <text x="780" y="92" font-size="10" text-anchor="middle" fill="white">Actuator Ctrl</text>
      
      <rect x="720" y="120" width="120" height="80" rx="3" fill="white" stroke="#8E24AA"/>
      <rect x="725" y="125" width="110" height="12" rx="2" fill="#8E24AA"/>
      <text x="780" y="133" font-size="8" text-anchor="middle" fill="white">Brake Command</text>
      <rect x="725" y="140" width="110" height="12" rx="2" fill="#1E88E5"/>
      <text x="780" y="148" font-size="8" text-anchor="middle" fill="white">SOME/IP</text>
      <rect x="725" y="155" width="110" height="12" rx="2" fill="#43A047"/>
      <text x="780" y="163" font-size="8" text-anchor="middle" fill="white">UDP Reliable</text>
      <rect x="725" y="170" width="110" height="12" rx="2" fill="#FB8C00"/>
      <text x="780" y="178" font-size="8" text-anchor="middle" fill="white">IPv4 P2P</text>
      <rect x="725" y="185" width="110" height="12" rx="2" fill="#546E7A"/>
      <text x="780" y="193" font-size="8" text-anchor="middle" fill="white">100BASE-T1</text>
      
      <!-- Flow arrows with timing -->
      <line x1="120" y1="80" x2="180" y2="80" stroke="#4CAF50" stroke-width="3" marker-end="url(#dataArrow)" stroke-dasharray="10,5">
        <animate attributeName="stroke-dashoffset" values="15;0" dur="1s" repeatCount="indefinite"/>
      </line>
      <text x="150" y="70" font-size="10" text-anchor="middle" fill="#333">t+0ms</text>
      
      <line x1="300" y1="80" x2="360" y2="80" stroke="#FF9800" stroke-width="3" marker-end="url(#dataArrow)" stroke-dasharray="10,5">
        <animate attributeName="stroke-dashoffset" values="15;0" dur="1s" begin="0.2s" repeatCount="indefinite"/>
      </line>
      <text x="330" y="70" font-size="10" text-anchor="middle" fill="#333">t+0.5ms</text>
      
      <line x1="480" y1="80" x2="540" y2="80" stroke="#E53935" stroke-width="3" marker-end="url(#dataArrow)" stroke-dasharray="10,5">
        <animate attributeName="stroke-dashoffset" values="15;0" dur="1s" begin="0.4s" repeatCount="indefinite"/>
      </line>
      <text x="510" y="70" font-size="10" text-anchor="middle" fill="#333">t+1ms</text>
      
      <line x1="660" y1="80" x2="720" y2="80" stroke="#1E88E5" stroke-width="3" marker-end="url(#dataArrow)" stroke-dasharray="10,5">
        <animate attributeName="stroke-dashoffset" values="15;0" dur="1s" begin="0.6s" repeatCount="indefinite"/>
      </line>
      <text x="690" y="70" font-size="10" text-anchor="middle" fill="#333">t+2ms</text>
      
      <!-- Total latency -->
      <rect x="900" y="50" width="200" height="150" rx="10" fill="#263238"/>
      <text x="1000" y="75" font-size="14" font-weight="bold" text-anchor="middle" fill="#00FF00">Total E2E Latency</text>
      <text x="1000" y="100" font-size="20" font-weight="bold" text-anchor="middle" fill="#FFEB3B">2.3ms</text>
      <text x="1000" y="125" font-size="12" text-anchor="middle" fill="#00FF00">Target: &lt; 5ms</text>
      <text x="1000" y="145" font-size="12" text-anchor="middle" fill="#00FF00">Status: PASS</text>
      <circle cx="1070" cy="175" r="12" fill="#00FF00">
        <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite"/>
      </circle>
      <text x="1070" y="180" font-size="8" text-anchor="middle" fill="black">OK</text>
    </g>
  </g>
</svg>