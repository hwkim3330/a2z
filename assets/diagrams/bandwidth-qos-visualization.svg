<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2400 1800">
  <defs>
    <!-- Traffic class gradients -->
    <linearGradient id="critical" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#D32F2F;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#B71C1C;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="control" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F57C00;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#E65100;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="av" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1976D2;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#0D47A1;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="video" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#388E3C;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#1B5E20;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="voice" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7B1FA2;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#4A148C;stop-opacity:1"/>
    </linearGradient>
    
    <linearGradient id="best" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#616161;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#424242;stop-opacity:1"/>
    </linearGradient>
    
    <!-- Flow gradients -->
    <radialGradient id="flowGradient" cx="50%" cy="50%" r="50%">
      <stop offset="0%" style="stop-color:#00E676;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#00C853;stop-opacity:0.3"/>
    </radialGradient>
    
    <!-- Patterns -->
    <pattern id="hatchPattern" x="0" y="0" width="8" height="8" patternUnits="userSpaceOnUse">
      <path d="M0,8 L8,0" stroke="#ffffff" stroke-width="1" opacity="0.3"/>
    </pattern>
    
    <!-- Arrow markers -->
    <marker id="flowArrow" markerWidth="12" markerHeight="12" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 z" fill="#4CAF50"/>
    </marker>
    
    <!-- Filters -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge> 
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-opacity="0.2"/>
    </filter>
    
    <!-- Grid pattern -->
    <pattern id="gridPattern" x="0" y="0" width="30" height="30" patternUnits="userSpaceOnUse">
      <line x1="0" y1="0" x2="0" y2="30" stroke="#E8E8E8" stroke-width="0.5"/>
      <line x1="0" y1="0" x2="30" y2="0" stroke="#E8E8E8" stroke-width="0.5"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect x="0" y="0" width="2400" height="1800" fill="#FAFAFA"/>
  <rect x="0" y="0" width="2400" height="1800" fill="url(#gridPattern)"/>
  
  <!-- Title -->
  <text x="1200" y="40" font-size="36" font-weight="bold" text-anchor="middle" fill="#1A237E">
    A2Z Network Bandwidth Allocation &amp; QoS Management
  </text>
  <text x="1200" y="75" font-size="20" text-anchor="middle" fill="#3F51B5">
    Real-time Traffic Shaping and Priority-based Resource Management
  </text>
  
  <!-- Total Bandwidth Overview (Top) -->
  <g transform="translate(100, 120)">
    <rect x="0" y="0" width="2200" height="200" rx="15" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
    <text x="1100" y="35" font-size="24" font-weight="bold" text-anchor="middle" fill="#2C3E50">
      Total Network Capacity: 25 Gbps Aggregate
    </text>
    
    <!-- Capacity bars -->
    <g transform="translate(50, 60)">
      <!-- 10GbE Backbone -->
      <rect x="0" y="0" width="800" height="40" rx="5" fill="#263238"/>
      <text x="400" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#00FF00">
        10GbE Backbone (Central Switch): 10.0 Gbps
      </text>
      <rect x="0" y="45" width="480" height="8" rx="4" fill="#4CAF50"/>
      <text x="490" y="52" font-size="11" fill="#333">4.8/10.0 Gbps (48% utilized)</text>
      
      <!-- 2.5GbE Links -->
      <rect x="850" y="0" width="600" height="40" rx="5" fill="#37474F"/>
      <text x="1150" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#00FF00">
        2.5GbE Links (6 ports): 15.0 Gbps
      </text>
      <rect x="850" y="45" width="390" height="8" rx="4" fill="#2196F3"/>
      <text x="1250" y="52" font-size="11" fill="#333">6.5/15.0 Gbps (43% utilized)</text>
      
      <!-- 1GbE Access -->
      <rect x="1500" y="0" width="600" height="40" rx="5" fill="#455A64"/>
      <text x="1800" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#00FF00">
        1GbE Access (20 ports): 20.0 Gbps  
      </text>
      <rect x="1500" y="45" width="180" height="8" rx="4" fill="#FF9800"/>
      <text x="1690" y="52" font-size="11" fill="#333">3.0/20.0 Gbps (15% utilized)</text>
    </g>
    
    <!-- Real-time utilization -->
    <g transform="translate(50, 120)">
      <rect x="0" y="0" width="2100" height="60" rx="5" fill="#1A237E"/>
      <text x="1050" y="25" font-size="16" font-weight="bold" text-anchor="middle" fill="#00FF00">
        Current Total Utilization: 14.3/45.0 Gbps (31.8%) - Peak: 18.7 Gbps (41.6%)
      </text>
      
      <!-- Utilization bar with segments -->
      <g transform="translate(100, 35)">
        <!-- Critical traffic -->
        <rect x="0" y="0" width="120" height="15" rx="2" fill="url(#critical)"/>
        <text x="60" y="11" font-size="9" text-anchor="middle" fill="white">Critical: 0.8G</text>
        
        <!-- Control traffic -->
        <rect x="120" y="0" width="180" height="15" rx="2" fill="url(#control)"/>
        <text x="210" y="11" font-size="9" text-anchor="middle" fill="white">Control: 1.2G</text>
        
        <!-- AV traffic -->
        <rect x="300" y="0" width="480" height="15" rx="2" fill="url(#av)"/>
        <text x="540" y="11" font-size="9" text-anchor="middle" fill="white">AV Data: 3.2G</text>
        
        <!-- Video traffic -->
        <rect x="780" y="0" width="1020" height="15" rx="2" fill="url(#video)"/>
        <text x="1290" y="11" font-size="9" text-anchor="middle" fill="white">Video/Sensor: 6.8G</text>
        
        <!-- Voice traffic -->
        <rect x="1800" y="0" width="180" height="15" rx="2" fill="url(#voice)"/>
        <text x="1890" y="11" font-size="9" text-anchor="middle" fill="white">Voice: 1.2G</text>
        
        <!-- Best effort -->
        <rect x="1980" y="0" width="120" height="15" rx="2" fill="url(#best)"/>
        <text x="2040" y="11" font-size="9" text-anchor="middle" fill="white">Best: 1.1G</text>
      </g>
    </g>
  </g>
  
  <!-- TSN Traffic Shaping Configuration (Left Side) -->
  <g transform="translate(100, 360)">
    <rect x="0" y="0" width="1100" height="1000" rx="15" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
    <text x="550" y="35" font-size="22" font-weight="bold" text-anchor="middle" fill="#1565C0">
      TSN Traffic Shaping &amp; Scheduling
    </text>
    
    <!-- Credit-Based Shaper (CBS) Configuration -->
    <g transform="translate(40, 70)">
      <rect x="0" y="0" width="1020" height="180" rx="10" fill="#E3F2FD"/>
      <text x="510" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#0D47A1">
        IEEE 802.1Qav Credit-Based Shaper (CBS)
      </text>
      
      <!-- CBS Classes -->
      <g transform="translate(30, 45)">
        <!-- Class A (Voice) -->
        <rect x="0" y="0" width="240" height="100" rx="5" fill="white" stroke="#7B1FA2" stroke-width="2"/>
        <text x="120" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#7B1FA2">Class A (Voice)</text>
        <text x="10" y="40" font-size="11" fill="#333">Bandwidth: 1.5 Gbps (3%)</text>
        <text x="10" y="55" font-size="11" fill="#333">Idle Slope: +750</text>
        <text x="10" y="70" font-size="11" fill="#333">Send Slope: -750</text>
        <text x="10" y="85" font-size="11" fill="#333">Credit: +32KB / -32KB</text>
        
        <!-- Class B (Video) -->
        <rect x="260" y="0" width="240" height="100" rx="5" fill="white" stroke="#388E3C" stroke-width="2"/>
        <text x="380" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#388E3C">Class B (Video)</text>
        <text x="270" y="40" font-size="11" fill="#333">Bandwidth: 7.5 Gbps (15%)</text>
        <text x="270" y="55" font-size="11" fill="#333">Idle Slope: +3750</text>
        <text x="270" y="70" font-size="11" fill="#333">Send Slope: -3750</text>
        <text x="270" y="85" font-size="11" fill="#333">Credit: +128KB / -128KB</text>
        
        <!-- Best Effort -->
        <rect x="520" y="0" width="240" height="100" rx="5" fill="white" stroke="#616161" stroke-width="2"/>
        <text x="640" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#616161">Best Effort</text>
        <text x="530" y="40" font-size="11" fill="#333">Bandwidth: Remaining</text>
        <text x="530" y="55" font-size="11" fill="#333">No shaping</text>
        <text x="530" y="70" font-size="11" fill="#333">Default queue</text>
        <text x="530" y="85" font-size="11" fill="#333">Preemptable</text>
        
        <!-- Real-time status -->
        <rect x="780" y="0" width="210" height="100" rx="5" fill="#263238"/>
        <text x="885" y="20" font-size="12" font-weight="bold" text-anchor="middle" fill="#00FF00">Live Status</text>
        <g font-family="monospace" font-size="9" fill="#76FF03">
          <text x="790" y="35">Class A Credit: +18KB</text>
          <text x="790" y="48">Class B Credit: -45KB</text>
          <text x="790" y="61">Queue Depth A: 12</text>
          <text x="790" y="74">Queue Depth B: 156</text>
          <text x="790" y="87">Scheduler: Active</text>
        </g>
      </g>
    </g>
    
    <!-- Time-Aware Shaper (TAS) Configuration -->
    <g transform="translate(40, 270)">
      <rect x="0" y="0" width="1020" height="240" rx="10" fill="#FFF3E0"/>
      <text x="510" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#E65100">
        IEEE 802.1Qbv Time-Aware Shaper (TAS)
      </text>
      
      <!-- Gate Control List -->
      <g transform="translate(30, 45)">
        <text x="0" y="0" font-size="14" font-weight="bold" fill="#E65100">Gate Control List (GCL) - Cycle: 1ms</text>
        
        <!-- Time slots visualization -->
        <g transform="translate(0, 20)">
          <!-- Critical slot -->
          <rect x="0" y="0" width="100" height="60" rx="3" fill="url(#critical)" opacity="0.8"/>
          <text x="50" y="20" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Critical</text>
          <text x="50" y="35" font-size="10" text-anchor="middle" fill="white">100μs</text>
          <text x="50" y="50" font-size="9" text-anchor="middle" fill="white">Gates: C</text>
          
          <!-- Control slot -->
          <rect x="100" y="0" width="150" height="60" rx="3" fill="url(#control)" opacity="0.8"/>
          <text x="175" y="20" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Control</text>
          <text x="175" y="35" font-size="10" text-anchor="middle" fill="white">150μs</text>
          <text x="175" y="50" font-size="9" text-anchor="middle" fill="white">Gates: C+R</text>
          
          <!-- AV Data slot -->
          <rect x="250" y="0" width="300" height="60" rx="3" fill="url(#av)" opacity="0.8"/>
          <text x="400" y="20" font-size="11" font-weight="bold" text-anchor="middle" fill="white">AV Data</text>
          <text x="400" y="35" font-size="10" text-anchor="middle" fill="white">300μs</text>
          <text x="400" y="50" font-size="9" text-anchor="middle" fill="white">Gates: C+R+A</text>
          
          <!-- Video slot -->
          <rect x="550" y="0" width="200" height="60" rx="3" fill="url(#video)" opacity="0.8"/>
          <text x="650" y="20" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Video</text>
          <text x="650" y="35" font-size="10" text-anchor="middle" fill="white">200μs</text>
          <text x="650" y="50" font-size="9" text-anchor="middle" fill="white">Gates: All</text>
          
          <!-- Best Effort slot -->
          <rect x="750" y="0" width="250" height="60" rx="3" fill="url(#best)" opacity="0.8"/>
          <text x="875" y="20" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Best Effort</text>
          <text x="875" y="35" font-size="10" text-anchor="middle" fill="white">250μs</text>
          <text x="875" y="50" font-size="9" text-anchor="middle" fill="white">Gates: All</text>
          
          <!-- Current time marker -->
          <line x1="320" y1="70" x2="320" y2="85" stroke="#FF1744" stroke-width="4">
            <animate attributeName="x1" values="0;1000;0" dur="5s" repeatCount="indefinite"/>
            <animate attributeName="x2" values="0;1000;0" dur="5s" repeatCount="indefinite"/>
          </line>
          <text x="320" y="100" font-size="11" text-anchor="middle" fill="#FF1744">Current Time</text>
          
          <!-- Timeline -->
          <line x1="0" y1="110" x2="1000" y2="110" stroke="#333" stroke-width="1"/>
          <text x="0" y="125" font-size="9" fill="#333">0μs</text>
          <text x="250" y="125" font-size="9" text-anchor="middle" fill="#333">250μs</text>
          <text x="500" y="125" font-size="9" text-anchor="middle" fill="#333">500μs</text>
          <text x="750" y="125" font-size="9" text-anchor="middle" fill="#333">750μs</text>
          <text x="1000" y="125" font-size="9" text-anchor="end" fill="#333">1000μs</text>
        </g>
      </g>
      
      <!-- TAS Statistics -->
      <g transform="translate(30, 180)">
        <rect x="0" y="0" width="960" height="40" rx="5" fill="#263238"/>
        <g font-family="monospace" font-size="11" fill="#76FF03" transform="translate(20, 25)">
          <text x="0" y="0">Current Cycle: 47,592 | Slot: AV Data (320μs remaining)</text>
          <text x="450" y="0">Gate Violations: 0 | Schedule Drift: +12ns</text>
        </g>
      </g>
    </g>
    
    <!-- Per-Stream Filtering and Policing (PSFP) -->
    <g transform="translate(40, 530)">
      <rect x="0" y="0" width="1020" height="200" rx="10" fill="#F3E5F5"/>
      <text x="510" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#6A1B9A">
        IEEE 802.1Qci Per-Stream Filtering and Policing (PSFP)
      </text>
      
      <!-- Stream filters -->
      <g transform="translate(30, 45)">
        <rect x="0" y="0" width="300" height="120" rx="5" fill="white" stroke="#9C27B0" stroke-width="2"/>
        <text x="150" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#9C27B0">Safety Critical Streams</text>
        <text x="10" y="40" font-size="11" fill="#333">Stream ID: 1-100</text>
        <text x="10" y="55" font-size="11" fill="#333">Max Frame Size: 1518B</text>
        <text x="10" y="70" font-size="11" fill="#333">Max Rate: 100Mbps</text>
        <text x="10" y="85" font-size="11" fill="#333">Max Burst: 10KB</text>
        <text x="10" y="100" font-size="11" fill="#333">Action: Pass/Drop</text>
        
        <rect x="320" y="0" width="300" height="120" rx="5" fill="white" stroke="#9C27B0" stroke-width="2"/>
        <text x="470" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#9C27B0">Sensor Data Streams</text>
        <text x="330" y="40" font-size="11" fill="#333">Stream ID: 101-500</text>
        <text x="330" y="55" font-size="11" fill="#333">Max Frame Size: 9000B</text>
        <text x="330" y="70" font-size="11" fill="#333">Max Rate: 1Gbps</text>
        <text x="330" y="85" font-size="11" fill="#333">Max Burst: 100KB</text>
        <text x="330" y="100" font-size="11" fill="#333">Action: Shape/Queue</text>
        
        <rect x="640" y="0" width="320" height="120" rx="5" fill="white" stroke="#9C27B0" stroke-width="2"/>
        <text x="800" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#9C27B0">Best Effort Streams</text>
        <text x="650" y="40" font-size="11" fill="#333">Stream ID: 501+</text>
        <text x="650" y="55" font-size="11" fill="#333">Max Frame Size: 1518B</text>
        <text x="650" y="70" font-size="11" fill="#333">Max Rate: Unlimited</text>
        <text x="650" y="85" font-size="11" fill="#333">Max Burst: 1MB</text>
        <text x="650" y="100" font-size="11" fill="#333">Action: Rate Limit</text>
      </g>
    </g>
    
    <!-- Frame Replication and Elimination (FRER) -->
    <g transform="translate(40, 750)">
      <rect x="0" y="0" width="1020" height="180" rx="10" fill="#E8F5E9"/>
      <text x="510" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#2E7D32">
        IEEE 802.1CB Frame Replication and Elimination (FRER)
      </text>
      
      <g transform="translate(30, 45)">
        <!-- Replication -->
        <rect x="0" y="0" width="320" height="100" rx="5" fill="white" stroke="#4CAF50" stroke-width="2"/>
        <text x="160" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#4CAF50">Frame Replication</text>
        <text x="10" y="40" font-size="11" fill="#333">Sequence Generation: Per-stream</text>
        <text x="10" y="55" font-size="11" fill="#333">Replication Points: 2-4 paths</text>
        <text x="10" y="70" font-size="11" fill="#333">Sequence Numbering: 16-bit</text>
        <text x="10" y="85" font-size="11" fill="#333">Status: Active (847 streams)</text>
        
        <!-- Elimination -->
        <rect x="340" y="0" width="320" height="100" rx="5" fill="white" stroke="#4CAF50" stroke-width="2"/>
        <text x="500" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#4CAF50">Frame Elimination</text>
        <text x="350" y="40" font-size="11" fill="#333">Recovery Window: 128 frames</text>
        <text x="350" y="55" font-size="11" fill="#333">History Length: 64 sequences</text>
        <text x="350" y="70" font-size="11" fill="#333">Duplicate Elimination: 99.8%</text>
        <text x="350" y="85" font-size="11" fill="#333">Latency Recovery: &lt;1ms</text>
        
        <!-- Statistics -->
        <rect x="680" y="0" width="310" height="100" rx="5" fill="#263238"/>
        <text x="835" y="20" font-size="12" font-weight="bold" text-anchor="middle" fill="#00FF00">FRER Statistics</text>
        <g font-family="monospace" font-size="10" fill="#76FF03" transform="translate(690, 30)">
          <text x="0" y="10">Replicated: 2.4M frames</text>
          <text x="0" y="25">Eliminated: 12K duplicates</text>
          <text x="0" y="40">Path Failures: 3</text>
          <text x="0" y="55">Recovery Time: 0.8ms avg</text>
          <text x="0" y="70">Availability: 99.999%</text>
        </g>
      </g>
    </g>
  </g>
  
  <!-- Priority Queue Management (Right Side) -->
  <g transform="translate(1250, 360)">
    <rect x="0" y="0" width="1050" height="1000" rx="15" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
    <text x="525" y="35" font-size="22" font-weight="bold" text-anchor="middle" fill="#D32F2F">
      Priority Queue Management &amp; Scheduling
    </text>
    
    <!-- Strict Priority Scheduling -->
    <g transform="translate(40, 70)">
      <rect x="0" y="0" width="970" height="280" rx="10" fill="#FFEBEE"/>
      <text x="485" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#B71C1C">
        Strict Priority + WRR Hybrid Scheduling
      </text>
      
      <!-- Priority queue visualization -->
      <g transform="translate(30, 50)">
        <!-- Queue 7 (Highest) -->
        <rect x="0" y="0" width="900" height="30" rx="5" fill="url(#critical)" opacity="0.9"/>
        <text x="20" y="20" font-size="12" font-weight="bold" fill="white">P7: Network Control (Emergency)</text>
        <text x="400" y="20" font-size="11" fill="white">Queue Depth: 0 | Max: 32 | Drop: 0</text>
        <text x="750" y="20" font-size="11" fill="white">Rate: 500 Mbps</text>
        <rect x="820" y="5" width="60" height="20" rx="3" fill="rgba(255,255,255,0.3)"/>
        <rect x="822" y="7" width="12" height="16" rx="2" fill="#00FF00"/>
        <text x="847" y="18" font-size="9" text-anchor="middle" fill="white">5%</text>
        
        <!-- Queue 6 -->
        <rect x="0" y="35" width="900" height="30" rx="5" fill="url(#control)" opacity="0.9"/>
        <text x="20" y="55" font-size="12" font-weight="bold" fill="white">P6: Internetwork Control (Safety)</text>
        <text x="400" y="55" font-size="11" fill="white">Queue Depth: 8 | Max: 64 | Drop: 0</text>
        <text x="750" y="55" font-size="11" fill="white">Rate: 1.2 Gbps</text>
        <rect x="820" y="40" width="60" height="20" rx="3" fill="rgba(255,255,255,0.3)"/>
        <rect x="822" y="42" width="18" height="16" rx="2" fill="#00FF00"/>
        <text x="847" y="53" font-size="9" text-anchor="middle" fill="white">15%</text>
        
        <!-- Queue 5 -->
        <rect x="0" y="70" width="900" height="30" rx="5" fill="url(#voice)" opacity="0.9"/>
        <text x="20" y="90" font-size="12" font-weight="bold" fill="white">P5: Voice (Critical AV Data)</text>
        <text x="400" y="90" font-size="11" fill="white">Queue Depth: 24 | Max: 128 | Drop: 2</text>
        <text x="750" y="90" font-size="11" fill="white">Rate: 3.2 Gbps</text>
        <rect x="820" y="75" width="60" height="20" rx="3" fill="rgba(255,255,255,0.3)"/>
        <rect x="822" y="77" width="36" height="16" rx="2" fill="#00FF00"/>
        <text x="847" y="88" font-size="9" text-anchor="middle" fill="white">30%</text>
        
        <!-- Queue 4 -->
        <rect x="0" y="105" width="900" height="30" rx="5" fill="url(#video)" opacity="0.9"/>
        <text x="20" y="125" font-size="12" font-weight="bold" fill="white">P4: Video (Sensor Streams)</text>
        <text x="400" y="125" font-size="11" fill="white">Queue Depth: 156 | Max: 512 | Drop: 28</text>
        <text x="750" y="125" font-size="11" fill="white">Rate: 6.8 Gbps</text>
        <rect x="820" y="110" width="60" height="20" rx="3" fill="rgba(255,255,255,0.3)"/>
        <rect x="822" y="112" width="42" height="16" rx="2" fill="#FF9800"/>
        <text x="847" y="123" font-size="9" text-anchor="middle" fill="white">35%</text>
        
        <!-- Queue 3 -->
        <rect x="0" y="140" width="900" height="30" rx="5" fill="url(#av)" opacity="0.7"/>
        <text x="20" y="160" font-size="12" font-weight="bold" fill="white">P3: Excellent Effort (Localization)</text>
        <text x="400" y="160" font-size="11" fill="white">Queue Depth: 45 | Max: 256 | Drop: 8</text>
        <text x="750" y="160" font-size="11" fill="white">Rate: 1.2 Gbps</text>
        <rect x="820" y="145" width="60" height="20" rx="3" fill="rgba(255,255,255,0.3)"/>
        <rect x="822" y="147" width="15" height="16" rx="2" fill="#2196F3"/>
        <text x="847" y="158" font-size="9" text-anchor="middle" fill="white">10%</text>
        
        <!-- Queue 0-2 (Best Effort) -->
        <rect x="0" y="175" width="900" height="40" rx="5" fill="url(#best)" opacity="0.7"/>
        <text x="20" y="190" font-size="12" font-weight="bold" fill="white">P0-P2: Best Effort (Diagnostics, Updates)</text>
        <text x="20" y="205" font-size="11" fill="white">Combined Depth: 89 | Max: 1024 | Drop: 156</text>
        <text x="400" y="195" font-size="11" fill="white">Rate: 1.1 Gbps | WRR Weights: 1:2:3</text>
        <text x="750" y="195" font-size="11" fill="white">Remaining BW</text>
        <rect x="820" y="180" width="60" height="20" rx="3" fill="rgba(255,255,255,0.3)"/>
        <rect x="822" y="182" width="8" height="16" rx="2" fill="#9E9E9E"/>
        <text x="847" y="193" font-size="9" text-anchor="middle" fill="white">5%</text>
      </g>
    </g>
    
    <!-- Buffer Management -->
    <g transform="translate(40, 370)">
      <rect x="0" y="0" width="970" height="200" rx="10" fill="#E1F5FE"/>
      <text x="485" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#0D47A1">
        Buffer Pool Management (WRED + Tail Drop)
      </text>
      
      <!-- Buffer pool visualization -->
      <g transform="translate(30, 50)">
        <text x="0" y="0" font-size="14" font-weight="bold" fill="#1565C0">Total Buffer: 64MB | Allocated: 42.8MB (66.9%)</text>
        
        <!-- Buffer allocation bars -->
        <g transform="translate(0, 20)">
          <!-- Guaranteed buffers -->
          <rect x="0" y="0" width="300" height="40" rx="5" fill="#4CAF50"/>
          <text x="150" y="25" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
            Guaranteed: 32MB (50%)
          </text>
          
          <!-- Shared buffers -->
          <rect x="310" y="0" width="200" height="40" rx="5" fill="#2196F3"/>
          <text x="410" y="25" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
            Shared: 20MB (31%)
          </text>
          
          <!-- Free buffers -->
          <rect x="520" y="0" width="150" height="40" rx="5" fill="#9E9E9E"/>
          <text x="595" y="25" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
            Free: 12MB (19%)
          </text>
          
          <!-- WRED Status -->
          <rect x="680" y="0" width="200" height="40" rx="5" fill="#263238"/>
          <text x="780" y="18" font-size="11" font-weight="bold" text-anchor="middle" fill="#00FF00">WRED Active</text>
          <text x="780" y="32" font-size="10" text-anchor="middle" fill="#76FF03">Drop Probability: 2.4%</text>
        </g>
        
        <!-- WRED thresholds -->
        <g transform="translate(0, 70)">
          <text x="0" y="0" font-size="12" font-weight="bold" fill="#333">WRED Thresholds by Priority:</text>
          
          <g transform="translate(0, 20)">
            <rect x="0" y="0" width="150" height="60" rx="3" fill="white" stroke="#B71C1C" stroke-width="2"/>
            <text x="75" y="15" font-size="11" font-weight="bold" text-anchor="middle" fill="#B71C1C">P6-P7</text>
            <text x="10" y="30" font-size="9" fill="#333">Min: 90%</text>
            <text x="10" y="42" font-size="9" fill="#333">Max: 95%</text>
            <text x="10" y="54" font-size="9" fill="#333">Drop: 0%</text>
            
            <rect x="160" y="0" width="150" height="60" rx="3" fill="white" stroke="#F57C00" stroke-width="2"/>
            <text x="235" y="15" font-size="11" font-weight="bold" text-anchor="middle" fill="#F57C00">P4-P5</text>
            <text x="170" y="30" font-size="9" fill="#333">Min: 70%</text>
            <text x="170" y="42" font-size="9" fill="#333">Max: 85%</text>
            <text x="170" y="54" font-size="9" fill="#333">Drop: 1.2%</text>
            
            <rect x="320" y="0" width="150" height="60" rx="3" fill="white" stroke="#1976D2" stroke-width="2"/>
            <text x="395" y="15" font-size="11" font-weight="bold" text-anchor="middle" fill="#1976D2">P2-P3</text>
            <text x="330" y="30" font-size="9" fill="#333">Min: 50%</text>
            <text x="330" y="42" font-size="9" fill="#333">Max: 70%</text>
            <text x="330" y="54" font-size="9" fill="#333">Drop: 5.1%</text>
            
            <rect x="480" y="0" width="150" height="60" rx="3" fill="white" stroke="#616161" stroke-width="2"/>
            <text x="555" y="15" font-size="11" font-weight="bold" text-anchor="middle" fill="#616161">P0-P1</text>
            <text x="490" y="30" font-size="9" fill="#333">Min: 25%</text>
            <text x="490" y="42" font-size="9" fill="#333">Max: 50%</text>
            <text x="490" y="54" font-size="9" fill="#333">Drop: 12.8%</text>
          </g>
        </g>
      </g>
    </g>
    
    <!-- Traffic Flow Monitoring -->
    <g transform="translate(40, 590)">
      <rect x="0" y="0" width="970" height="180" rx="10" fill="#FFF3E0"/>
      <text x="485" y="25" font-size="18" font-weight="bold" text-anchor="middle" fill="#E65100">
        Real-Time Traffic Flow Analysis
      </text>
      
      <!-- Flow meters -->
      <g transform="translate(30, 50)">
        <rect x="0" y="0" width="280" height="100" rx="5" fill="white" stroke="#FF9800" stroke-width="2"/>
        <text x="140" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#FF9800">Ingress Policing</text>
        <text x="10" y="40" font-size="11" fill="#333">Committed Rate: 8 Gbps</text>
        <text x="10" y="55" font-size="11" fill="#333">Burst Size: 1MB</text>
        <text x="10" y="70" font-size="11" fill="#333">Violating Packets: 234</text>
        <text x="10" y="85" font-size="11" fill="#333">Action: Drop + Log</text>
        
        <rect x="300" y="0" width="280" height="100" rx="5" fill="white" stroke="#FF9800" stroke-width="2"/>
        <text x="440" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#FF9800">Egress Shaping</text>
        <text x="310" y="40" font-size="11" fill="#333">Shaped Rate: 10 Gbps</text>
        <text x="310" y="55" font-size="11" fill="#333">Queue Length: 45ms</text>
        <text x="310" y="70" font-size="11" fill="#333">Delayed Packets: 1,203</text>
        <text x="310" y="85" font-size="11" fill="#333">Action: Buffer + Shape</text>
        
        <rect x="600" y="0" width="280" height="100" rx="5" fill="white" stroke="#FF9800" stroke-width="2"/>
        <text x="740" y="20" font-size="14" font-weight="bold" text-anchor="middle" fill="#FF9800">Flow Classification</text>
        <text x="610" y="40" font-size="11" fill="#333">Classified Flows: 2,847</text>
        <text x="610" y="55" font-size="11" fill="#333">Microflows: 156,023</text>
        <text x="610" y="70" font-size="11" fill="#333">Elephant Flows: 12</text>
        <text x="610" y="85" font-size="11" fill="#333">Action: Track + Shape</text>
      </g>
    </g>
    
    <!-- Performance Metrics -->
    <g transform="translate(40, 790)">
      <rect x="0" y="0" width="970" height="180" rx="10" fill="#263238"/>
      <text x="485" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#00FF00">
        QoS Performance Dashboard
      </text>
      
      <g transform="translate(30, 50)" font-family="monospace">
        <!-- Left column -->
        <g font-size="11" fill="#76FF03">
          <text x="0" y="0">Average Queue Latency:</text>
          <text x="0" y="20">• P7 (Critical): 0.12ms</text>
          <text x="0" y="35">• P6 (Safety): 0.85ms</text>
          <text x="0" y="50">• P5 (AV Data): 2.4ms</text>
          <text x="0" y="65">• P4 (Video): 8.7ms</text>
          <text x="0" y="80">• P3 (Excellent): 15.2ms</text>
          <text x="0" y="95">• P0-P2 (Best): 45.8ms</text>
        </g>
        
        <!-- Middle column -->
        <g transform="translate(230, 0)" font-size="11" fill="#FFEB3B">
          <text x="0" y="0">Jitter Analysis:</text>
          <text x="0" y="20">• P7: ±0.05ms (Target: ±0.1ms)</text>
          <text x="0" y="35">• P6: ±0.3ms (Target: ±0.5ms)</text>
          <text x="0" y="50">• P5: ±1.2ms (Target: ±2ms)</text>
          <text x="0" y="65">• P4: ±4.1ms (Target: ±10ms)</text>
          <text x="0" y="80">Packet Loss Rate: 0.001%</text>
          <text x="0" y="95">SLA Compliance: 99.97%</text>
        </g>
        
        <!-- Right column -->
        <g transform="translate(490, 0)" font-size="11" fill="#FF8A80">
          <text x="0" y="0">Congestion Control:</text>
          <text x="0" y="20">• ECN Marks: 1,247 packets</text>
          <text x="0" y="35">• Buffer Overruns: 3</text>
          <text x="0" y="50">• Flow Control: 89 pauses</text>
          <text x="0" y="65">• Backpressure: Active</text>
          <text x="0" y="80">• Load Balancing: 4 paths</text>
          <text x="0" y="95">• Health Score: 98.2%</text>
        </g>
      </g>
    </g>
  </g>
  
  <!-- Network Topology with Flow Visualization -->
  <g transform="translate(100, 1400)">
    <rect x="0" y="0" width="2200" height="350" rx="15" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
    <text x="1100" y="35" font-size="22" font-weight="bold" text-anchor="middle" fill="#1A237E">
      Live Traffic Flow Visualization - Autonomous Emergency Braking Scenario
    </text>
    
    <!-- Network nodes -->
    <g transform="translate(100, 80)">
      <!-- Sensor node -->
      <circle cx="100" cy="100" r="40" fill="url(#critical)" filter="url(#glow)"/>
      <text x="100" y="95" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Radar</text>
      <text x="100" y="110" font-size="10" text-anchor="middle" fill="white">ECU</text>
      <circle cx="130" cy="70" r="6" fill="#FFEB3B">
        <animate attributeName="opacity" values="0;1;0" dur="0.5s" repeatCount="indefinite"/>
      </circle>
      
      <!-- TSN Switch 1 -->
      <rect x="300" y="70" width="80" height="60" rx="10" fill="url(#control)" filter="url(#glow)"/>
      <text x="340" y="95" font-size="12" font-weight="bold" text-anchor="middle" fill="white">TSN-SW1</text>
      <text x="340" y="110" font-size="9" text-anchor="middle" fill="white">LAN9692</text>
      
      <!-- Central Backbone Switch -->
      <rect x="600" y="50" width="100" height="100" rx="15" fill="#1A237E" filter="url(#glow)"/>
      <text x="650" y="95" font-size="14" font-weight="bold" text-anchor="middle" fill="#00FF00">Core</text>
      <text x="650" y="110" font-size="10" text-anchor="middle" fill="#00FF00">10GbE</text>
      <text x="650" y="125" font-size="9" text-anchor="middle" fill="#76FF03">LAN9662</text>
      
      <!-- Processing ECU -->
      <rect x="900" y="70" width="80" height="60" rx="10" fill="url(#av)" filter="url(#glow)"/>
      <text x="940" y="95" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ACU_NO</text>
      <text x="940" y="110" font-size="9" text-anchor="middle" fill="white">Jetson</text>
      
      <!-- TSN Switch 2 -->
      <rect x="1200" y="70" width="80" height="60" rx="10" fill="url(#control)" filter="url(#glow)"/>
      <text x="1240" y="95" font-size="12" font-weight="bold" text-anchor="middle" fill="white">TSN-SW2</text>
      <text x="1240" y="110" font-size="9" text-anchor="middle" fill="white">LAN9668</text>
      
      <!-- Actuator ECU -->
      <circle cx="1500" cy="100" r="40" fill="url(#critical)" filter="url(#glow)"/>
      <text x="1500" y="95" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Brake</text>
      <text x="1500" y="110" font-size="10" text-anchor="middle" fill="white">ECU</text>
      <circle cx="1470" cy="70" r="6" fill="#FF5252">
        <animate attributeName="opacity" values="0;1;0" dur="0.3s" repeatCount="indefinite"/>
      </circle>
      
      <!-- Flow paths with animations -->
      <!-- Primary path -->
      <path d="M140,100 Q220,100 300,100" stroke="url(#flowGradient)" stroke-width="8" fill="none" marker-end="url(#flowArrow)" opacity="0.8">
        <animate attributeName="stroke-dasharray" values="0,100;50,50;100,0" dur="2s" repeatCount="indefinite"/>
      </path>
      
      <path d="M380,100 Q490,100 600,100" stroke="url(#flowGradient)" stroke-width="8" fill="none" marker-end="url(#flowArrow)" opacity="0.8">
        <animate attributeName="stroke-dasharray" values="0,100;50,50;100,0" dur="2s" begin="0.2s" repeatCount="indefinite"/>
      </path>
      
      <path d="M700,100 Q800,100 900,100" stroke="url(#flowGradient)" stroke-width="8" fill="none" marker-end="url(#flowArrow)" opacity="0.8">
        <animate attributeName="stroke-dasharray" values="0,100;50,50;100,0" dur="2s" begin="0.4s" repeatCount="indefinite"/>
      </path>
      
      <path d="M980,100 Q1090,100 1200,100" stroke="url(#flowGradient)" stroke-width="8" fill="none" marker-end="url(#flowArrow)" opacity="0.8">
        <animate attributeName="stroke-dasharray" values="0,100;50,50;100,0" dur="2s" begin="0.6s" repeatCount="indefinite"/>
      </path>
      
      <path d="M1280,100 Q1390,100 1460,100" stroke="url(#flowGradient)" stroke-width="8" fill="none" marker-end="url(#flowArrow)" opacity="0.8">
        <animate attributeName="stroke-dasharray" values="0,100;50,50;100,0" dur="2s" begin="0.8s" repeatCount="indefinite"/>
      </path>
      
      <!-- Redundant path (FRER) -->
      <path d="M380,80 Q650,20 980,80" stroke="#FF9800" stroke-width="4" fill="none" stroke-dasharray="10,5" opacity="0.6">
        <animate attributeName="stroke-dasharray" values="10,5;5,10;10,5" dur="3s" repeatCount="indefinite"/>
      </path>
      <text x="680" y="45" font-size="11" text-anchor="middle" fill="#F57C00">FRER Backup Path</text>
      
      <!-- Timing annotations -->
      <g transform="translate(0, 200)" font-family="monospace" font-size="12">
        <rect x="0" y="0" width="2000" height="100" rx="5" fill="#263238"/>
        <text x="1000" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#00FF00">End-to-End Latency Breakdown</text>
        
        <g fill="#76FF03" transform="translate(50, 45)">
          <text x="0" y="0">Sensor → SW1: 0.2ms (CAN-FD processing)</text>
          <text x="0" y="15">SW1 → Core: 0.3ms (TSN scheduling)</text>
          <text x="0" y="30">Core → ACU: 0.8ms (Processing + QoS)</text>
          <text x="0" y="45">ACU → SW2: 0.4ms (Decision logic)</text>
        </g>
        
        <g fill="#FFEB3B" transform="translate(600, 45)">
          <text x="0" y="0">SW2 → Brake: 0.3ms (Final hop)</text>
          <text x="0" y="15">Total E2E: 2.0ms (Target: &lt;5ms)</text>
          <text x="0" y="30">Jitter: ±0.15ms (Target: ±0.5ms)</text>
          <text x="0" y="45">Priority: P7 (Network Control)</text>
        </g>
        
        <g fill="#FF8A80" transform="translate(1200, 45)">
          <text x="0" y="0">Queue Delays: 0.8ms total</text>
          <text x="0" y="15">Serialization: 0.4ms</text>
          <text x="0" y="30">Propagation: 0.8ms</text>
          <text x="0" y="45">Status: MEETING SLA ✓</text>
        </g>
      </g>
      
      <!-- Bandwidth utilization bars -->
      <g transform="translate(50, 160)">
        <text x="0" y="0" font-size="12" font-weight="bold" fill="#333">Link Utilization:</text>
        
        <g transform="translate(0, 15)">
          <rect x="0" y="0" width="300" height="15" rx="3" fill="#E0E0E0"/>
          <rect x="0" y="0" width="180" height="15" rx="3" fill="#4CAF50"/>
          <text x="310" y="12" font-size="10" fill="#333">Sensor→SW1: 60%</text>
          
          <rect x="400" y="0" width="300" height="15" rx="3" fill="#E0E0E0"/>
          <rect x="400" y="0" width="240" height="15" rx="3" fill="#FF9800"/>
          <text x="710" y="12" font-size="10" fill="#333">SW1→Core: 80%</text>
          
          <rect x="800" y="0" width="300" height="15" rx="3" fill="#E0E0E0"/>
          <rect x="800" y="0" width="120" height="15" rx="3" fill="#2196F3"/>
          <text x="1110" y="12" font-size="10" fill="#333">Core→ACU: 40%</text>
          
          <rect x="1200" y="0" width="300" height="15" rx="3" fill="#E0E0E0"/>
          <rect x="1200" y="0" width="90" height="15" rx="3" fill="#4CAF50"/>
          <text x="1510" y="12" font-size="10" fill="#333">SW2→Brake: 30%</text>
        </g>
      </g>
    </g>
  </g>
</svg>